HIRE FLOW – RELEVANT SOURCE CODE EXPORT
Generated automatically by Python script
==========================================================================================


==========================================================================================
FOLDER: src/Controller
==========================================================================================


==========================================================================================
FILE: src\Controller\ApplicationController.php
==========================================================================================

<?php
// src/Controller/ApplicationController.php

namespace App\Controller;

use App\Entity\Application;
use App\Entity\Offer;
use App\Repository\ApplicationRepository;
use App\Repository\OfferRepository;
use Doctrine\ORM\EntityManagerInterface;
use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;
use Symfony\Component\HttpFoundation\JsonResponse;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\Routing\Attribute\Route;
use Symfony\Component\Security\Http\Attribute\IsGranted;

#[Route('/applications')]
class ApplicationController extends AbstractController
{
    // MAIN PAGE - Shows applications table
    #[Route('/', name: 'application_index')]
    public function index(ApplicationRepository $applicationRepository, OfferRepository $offerRepository): Response
    {
        $user = $this->getUser();

        if ($this->isGranted('ROLE_RECRUITER')) {
            // Recruiters see applications for their offers
            $applications = $applicationRepository->findByRecruiter($user);
            $offers = $offerRepository->findBy(['recruiter' => $user], ['createdAt' => 'DESC']);
        } else {
            // Candidates see their own applications
            $applications = $applicationRepository->findBy(['candidate' => $user], ['createdAt' => 'DESC']);
            $offers = [];
        }

        return $this->render('application/index.html.twig', [
            'applications' => $applications,
            'offers' => $offers,
            'user' => $user,
        ]);
    }

    // AJAX ENDPOINT: Get application details for view modal
    #[Route('/{id}/show', name: 'application_show', methods: ['GET'])]
    public function show(Application $application): JsonResponse
    {
        // Security check
        if ($this->isGranted('ROLE_RECRUITER')) {
            if ($application->getOffer()->getRecruiter() !== $this->getUser()) {
                return new JsonResponse([
                    'success' => false,
                    'error' => 'Access denied'
                ], 403);
            }
        } else {
            if ($application->getCandidate() !== $this->getUser()) {
                return new JsonResponse([
                    'success' => false,
                    'error' => 'Access denied'
                ], 403);
            }
        }

        return new JsonResponse([
            'success' => true,
            'application' => [
                'id' => $application->getId(),
                'candidateName' => $application->getCandidate()->getFullName(),
                'candidateEmail' => $application->getCandidate()->getEmail(),
                'candidatePhone' => $application->getCandidate()->getPhone(),
                'offerTitle' => $application->getOffer()->getTitle(),
                'coverLetter' => $application->getCoverLetter(),
                'resume' => $application->getResume(),
                'resumePath' => $application->getResumePath(),
                'status' => $application->getStatus(),
                'statusText' => $application->getStatusText(),
                'createdAt' => $application->getCreatedAt()->format('F d, Y H:i'),
                'notes' => $application->getNotes(),
            ]
        ]);
    }

    // AJAX ENDPOINT: Create new application (candidate applies to offer)
    #[Route('/new', name: 'application_new', methods: ['POST'])]
    #[IsGranted('ROLE_CANDIDATE')]
    public function new(Request $request, EntityManagerInterface $entityManager, OfferRepository $offerRepository): JsonResponse
    {
        $user = $this->getUser();

        try {
            // DEBUG: Log what we're receiving
            error_log('Received application submission:');
            error_log('Offer ID: ' . $request->request->get('offerId'));
            error_log('Cover letter length: ' . strlen($request->request->get('coverLetter', '')));
            error_log('Has file: ' . ($request->files->get('resume') ? 'YES' : 'NO'));

            if ($request->files->get('resume')) {
                error_log('File name: ' . $request->files->get('resume')->getClientOriginalName());
                error_log('File size: ' . $request->files->get('resume')->getSize());
                error_log('File type: ' . $request->files->get('resume')->getMimeType());
            }

            $offerId = $request->request->get('offerId');
            $coverLetter = $request->request->get('coverLetter');
            $resumeFile = $request->files->get('resume');

            // Validate required fields
            if (!$offerId) {
                return new JsonResponse([
                    'success' => false,
                    'error' => 'Offer ID is required'
                ], 400);
            }

            if (!$coverLetter || trim($coverLetter) === '') {
                return new JsonResponse([
                    'success' => false,
                    'error' => 'Cover letter is required'
                ], 400);
            }

            if (!$resumeFile) {
                return new JsonResponse([
                    'success' => false,
                    'error' => 'Resume file is required'
                ], 400);
            }

            // Validate file
            $allowedMimeTypes = ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'text/plain'];
            if (!in_array($resumeFile->getMimeType(), $allowedMimeTypes)) {
                return new JsonResponse([
                    'success' => false,
                    'error' => 'Invalid file type. Allowed: PDF, DOC, DOCX, TXT'
                ], 400);
            }

            if ($resumeFile->getSize() > 5 * 1024 * 1024) { // 5MB
                return new JsonResponse([
                    'success' => false,
                    'error' => 'File size must be less than 5MB'
                ], 400);
            }

            // Find offer
            $offer = $offerRepository->find($offerId);
            if (!$offer) {
                return new JsonResponse([
                    'success' => false,
                    'error' => 'Offer not found'
                ], 404);
            }

            // Check if already applied
            $existingApplication = $entityManager->getRepository(Application::class)
                ->findOneBy(['candidate' => $user, 'offer' => $offer]);

            if ($existingApplication) {
                return new JsonResponse([
                    'success' => false,
                    'error' => 'You have already applied to this offer'
                ], 400);
            }

            // Generate unique filename (SIMPLIFIED VERSION - no transliterator)
            $originalFilename = pathinfo($resumeFile->getClientOriginalName(), PATHINFO_FILENAME);

            // Simple sanitization without transliterator
            $safeFilename = preg_replace('/[^a-zA-Z0-9_-]/', '_', $originalFilename);
            $safeFilename = strtolower($safeFilename);

            // Add timestamp and unique ID for uniqueness
            $newFilename = $safeFilename . '_' . time() . '_' . uniqid() . '.' . $resumeFile->guessExtension();

            // Get uploads directory
            $uploadsDir = $this->getParameter('kernel.project_dir') . '/public/uploads/resumes';
            if (!is_dir($uploadsDir)) {
                mkdir($uploadsDir, 0755, true);
            }

            // Move the file to uploads directory
            $resumeFile->move($uploadsDir, $newFilename);

            // Create application
            $application = new Application();
            $application->setCandidate($user);
            $application->setOffer($offer);
            $application->setCoverLetter($coverLetter);
            $application->setResume($newFilename);
            $application->setStatus(Application::STATUS_PENDING);
            $application->setCreatedAt(new \DateTimeImmutable());

            $entityManager->persist($application);
            $entityManager->flush();

            return new JsonResponse([
                'success' => true,
                'message' => 'Application submitted successfully!',
                'application' => [
                    'id' => $application->getId(),
                    'offerTitle' => $application->getOffer()->getTitle(),
                    'createdAt' => $application->getCreatedAt()->format('Y-m-d H:i:s'),
                ]
            ]);

        } catch (\Exception $e) {
            // Log the full error
            error_log('Application submission error: ' . $e->getMessage());
            error_log('Stack trace: ' . $e->getTraceAsString());

            return new JsonResponse([
                'success' => false,
                'error' => 'An error occurred: ' . $e->getMessage(),
                'trace' => $e->getTraceAsString() // Remove this in production
            ], 500);
        }
    }
    // AJAX ENDPOINT: Get application data for edit modal (candidates only)
    #[Route('/{id}/edit', name: 'application_edit', methods: ['GET'])]
    #[IsGranted('ROLE_CANDIDATE')]
    public function edit(Application $application): JsonResponse
    {
        // Security check - only candidate who owns the application can edit
        if ($application->getCandidate() !== $this->getUser()) {
            return new JsonResponse([
                'success' => false,
                'error' => 'Access denied'
            ], 403);
        }

        // Can only edit pending applications
        if ($application->getStatus() !== Application::STATUS_PENDING) {
            return new JsonResponse([
                'success' => false,
                'error' => 'You can only edit pending applications'
            ], 400);
        }

        return new JsonResponse([
            'success' => true,
            'application' => [
                'id' => $application->getId(),
                'offerTitle' => $application->getOffer()->getTitle(),
                'coverLetter' => $application->getCoverLetter(),
                'resume' => $application->getResume(),
            ]
        ]);
    }

    // AJAX ENDPOINT: Update application (candidates only)
    #[Route('/{id}/update', name: 'application_update', methods: ['PUT'])]
    #[IsGranted('ROLE_CANDIDATE')]
    public function update(Request $request, Application $application, EntityManagerInterface $entityManager): JsonResponse
    {
        // Security check - only candidate who owns the application can update
        if ($application->getCandidate() !== $this->getUser()) {
            return new JsonResponse([
                'success' => false,
                'error' => 'Access denied'
            ], 403);
        }

        // Can only update pending applications
        if ($application->getStatus() !== Application::STATUS_PENDING) {
            return new JsonResponse([
                'success' => false,
                'error' => 'You can only update pending applications'
            ], 400);
        }

        try {
            $coverLetter = $request->request->get('coverLetter');
            $resumeFile = $request->files->get('resume');

            // Validate required fields
            if (!$coverLetter || trim($coverLetter) === '') {
                return new JsonResponse([
                    'success' => false,
                    'error' => 'Cover letter is required'
                ], 400);
            }

            // Update cover letter
            $application->setCoverLetter($coverLetter);

            // Update resume file if provided
            if ($resumeFile) {
                // Validate file
                $allowedMimeTypes = ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'text/plain'];
                if (!in_array($resumeFile->getMimeType(), $allowedMimeTypes)) {
                    return new JsonResponse([
                        'success' => false,
                        'error' => 'Invalid file type. Allowed: PDF, DOC, DOCX, TXT'
                    ], 400);
                }

                if ($resumeFile->getSize() > 5 * 1024 * 1024) { // 5MB
                    return new JsonResponse([
                        'success' => false,
                        'error' => 'File size must be less than 5MB'
                    ], 400);
                }

                // Delete old resume file if exists
                $oldResume = $application->getResume();
                if ($oldResume) {
                    $oldFilePath = $this->getParameter('kernel.project_dir') . '/public/uploads/resumes/' . $oldResume;
                    if (file_exists($oldFilePath)) {
                        unlink($oldFilePath);
                    }
                }
                // Generate unique filename
                $originalFilename = pathinfo($resumeFile->getClientOriginalName(), PATHINFO_FILENAME);
                $safeFilename = preg_replace('/[^a-zA-Z0-9_-]/', '_', $originalFilename);
                $safeFilename = strtolower($safeFilename);
                $newFilename = $safeFilename . '_' . time() . '_' . uniqid() . '.' . $resumeFile->guessExtension();
                // Get uploads directory
                $uploadsDir = $this->getParameter('kernel.project_dir') . '/public/uploads/resumes';
                if (!is_dir($uploadsDir)) {
                    mkdir($uploadsDir, 0755, true);
                }

                // Move the file to uploads directory
                $resumeFile->move($uploadsDir, $newFilename);
                $application->setResume($newFilename);
            }

            $entityManager->flush();

            return new JsonResponse([
                'success' => true,
                'message' => 'Application updated successfully!',
                'application' => [
                    'id' => $application->getId(),
                    'coverLetter' => $application->getCoverLetter(),
                ]
            ]);

        } catch (\Exception $e) {
            return new JsonResponse([
                'success' => false,
                'error' => 'An error occurred: ' . $e->getMessage()
            ], 500);
        }
    }

    // AJAX ENDPOINT: Delete application (candidates only)
    #[Route('/{id}/delete', name: 'application_delete', methods: ['DELETE'])]
    #[IsGranted('ROLE_CANDIDATE')]
    public function delete(Application $application, EntityManagerInterface $entityManager): JsonResponse
    {
        // Security check - only candidate who owns the application can delete
        if ($application->getCandidate() !== $this->getUser()) {
            return new JsonResponse([
                'success' => false,
                'error' => 'Access denied'
            ], 403);
        }

        // Can only delete pending applications
        if ($application->getStatus() !== Application::STATUS_PENDING) {
            return new JsonResponse([
                'success' => false,
                'error' => 'You can only delete pending applications'
            ], 400);
        }

        try {
            // Delete resume file if exists
            $resumeFile = $application->getResume();
            if ($resumeFile) {
                $filePath = $this->getParameter('kernel.project_dir') . '/public/uploads/resumes/' . $resumeFile;
                if (file_exists($filePath)) {
                    unlink($filePath);
                }
            }
            // Remove application
            $entityManager->remove($application);
            $entityManager->flush();

            return new JsonResponse([
                'success' => true,
                'message' => 'Application deleted successfully!'
            ]);

        } catch (\Exception $e) {
            return new JsonResponse([
                'success' => false,
                'error' => 'An error occurred: ' . $e->getMessage()
            ], 500);
        }
    }
    // AJAX ENDPOINT: Update application status (Accept/Reject)
    #[Route('/{id}/status', name: 'application_status', methods: ['PUT'])]
    #[IsGranted('ROLE_RECRUITER')]
    public function updateStatus(Request $request, Application $application, EntityManagerInterface $entityManager): JsonResponse
    {
        // Security check - only recruiter who owns the offer can update
        if ($application->getOffer()->getRecruiter() !== $this->getUser()) {
            return new JsonResponse([
                'success' => false,
                'error' => 'Access denied. You can only update applications for your offers.'
            ], 403);
        }

        $data = json_decode($request->getContent(), true);
        $status = $data['status'] ?? null;

        if (!in_array($status, [Application::STATUS_ACCEPTED, Application::STATUS_REJECTED, Application::STATUS_PENDING])) {
            return new JsonResponse([
                'success' => false,
                'error' => 'Invalid status'
            ], 400);
        }

        $application->setStatus($status);
        $entityManager->flush();

        $message = $status === Application::STATUS_ACCEPTED
            ? 'Application accepted successfully!'
            : ($status === Application::STATUS_REJECTED
                ? 'Application rejected successfully!'
                : 'Application status reset to pending.');

        return new JsonResponse([
            'success' => true,
            'message' => $message,
            'application' => [
                'id' => $application->getId(),
                'status' => $application->getStatus(),
                'statusText' => $application->getStatusText(),
                'statusBadgeClass' => $application->getStatusBadgeClass(),
            ]
        ]);
    }

    // AJAX ENDPOINT: Search and filter applications
    #[Route('/search', name: 'application_search', methods: ['GET'])]
    public function search(Request $request, ApplicationRepository $applicationRepository, OfferRepository $offerRepository): JsonResponse
    {
        $searchTerm = $request->query->get('q', '');
        $status = $request->query->get('status', '');
        $offerId = $request->query->get('offer', '');
        $page = (int) $request->query->get('page', 1);
        $limit = (int) $request->query->get('limit', 10);

        $user = $this->getUser();

        if ($this->isGranted('ROLE_RECRUITER')) {
            $result = $applicationRepository->searchForRecruiter(
                $user,
                $searchTerm,
                $status,
                $offerId,
                $page,
                $limit
            );
        } else {
            $result = $applicationRepository->searchForCandidate(
                $user,
                $searchTerm,
                $status,
                $page,
                $limit
            );
        }

        $applicationsData = [];
        foreach ($result['applications'] as $application) {
            $applicationsData[] = [
                'id' => $application->getId(),
                'candidateName' => $application->getCandidate()->getFullName(),
                'candidateEmail' => $application->getCandidate()->getEmail(),
                'offerTitle' => $application->getOffer()->getTitle(),
                'offerId' => $application->getOffer()->getId(),
                'coverLetter' => $application->getCoverLetter(),
                'resume' => $application->getResume(),
                'status' => $application->getStatus(),
                'statusText' => $application->getStatusText(),
                'statusBadgeClass' => $application->getStatusBadgeClass(),
                'createdAt' => $application->getCreatedAt()->format('M d, Y'),
            ];
        }

        // Get offers for filter dropdown (recruiters only)
        $offersData = [];
        if ($this->isGranted('ROLE_RECRUITER')) {
            $offers = $offerRepository->findBy(['recruiter' => $user], ['title' => 'ASC']);
            foreach ($offers as $offer) {
                $offersData[] = [
                    'id' => $offer->getId(),
                    'title' => $offer->getTitle(),
                    'applicationsCount' => $offer->getApplications()->count(),
                ];
            }
        }

        return new JsonResponse([
            'success' => true,
            'applications' => $applicationsData,
            'offers' => $offersData,
            'pagination' => [
                'total' => $result['total'],
                'page' => $result['page'],
                'limit' => $result['limit'],
                'totalPages' => $result['totalPages']
            ]
        ]);
    }

    // AJAX ENDPOINT: Get statistics for dashboard
    #[Route('/stats', name: 'application_stats', methods: ['GET'])]
    public function stats(ApplicationRepository $applicationRepository): JsonResponse
    {
        $user = $this->getUser();

        if ($this->isGranted('ROLE_RECRUITER')) {
            $stats = $applicationRepository->getRecruiterStats($user);
        } else {
            $stats = $applicationRepository->getCandidateStats($user);
        }

        return new JsonResponse([
            'success' => true,
            'stats' => $stats
        ]);
    }
}


==========================================================================================
FILE: src\Controller\CandidateDashboardController.php
==========================================================================================

<?php

namespace App\Controller;

use App\Repository\ApplicationRepository;
use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\Routing\Attribute\Route;

final class CandidateDashboardController extends AbstractController
{
    #[Route('/candidate/dashboard', name: 'candidate_dashboard')]
    public function index(ApplicationRepository $applicationRepository): Response
    {
        $this->denyAccessUnlessGranted('ROLE_CANDIDATE');
        $user = $this->getUser();
        $applications = $applicationRepository->findBy(
            ['candidate' => $user],
            ['createdAt' => "DESC"]
        );
        $stats = [
            "total"=>count($applications),
            "pending"=>0,
            "accepted"=>0,
            "rejected"=>0
        ];
        foreach ($applications as $app) {
            $status = strtolower($app->getStatus());
            if (isset($stats[$status])){
                $stats[$status]++;
            }
        }
        return $this->render('candidate_dashboard/index.html.twig', [
            'applications'=> $applications,
            'stats' => $stats,
        ]);
    }
}


==========================================================================================
FILE: src\Controller\HomeController.php
==========================================================================================

<?php

namespace App\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\Routing\Attribute\Route;

final class HomeController extends AbstractController
{
    #[Route('/home', name: 'app_home')]
    public function index(): Response
    {
        return $this->render('home/index.html.twig', [
            'controller_name' => 'HomeController',
        ]);
    }
}


==========================================================================================
FILE: src\Controller\OfferController.php
==========================================================================================

<?php

namespace App\Controller;

use App\Entity\Offer;
use App\Entity\User;
use App\Form\OfferType;
use App\Repository\OfferRepository;
use Doctrine\ORM\EntityManagerInterface;
use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;
use Symfony\Component\HttpFoundation\JsonResponse;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\Routing\Attribute\Route;
use Psr\Log\LoggerInterface;

class OfferController extends AbstractController
{
    // MAIN SINGLE PAGE - Shows table with modals for all actions
    #[Route('/offers', name: 'offer_index')]
    public function index(OfferRepository $offerRepository): Response
    {
        $user = $this->getUser();

        // Role-based data filtering
        if ($this->isGranted('ROLE_RECRUITER')) {
            $offers = $offerRepository->findBy(['recruiter' => $user], ['createdAt' => 'DESC']);
        } else {
            $offers = $offerRepository->findBy([], ['createdAt' => 'DESC']);
        }

        // Create empty form for modal
        $form = $this->createForm(OfferType::class, new Offer());

        return $this->render('offer/index.html.twig', [
            'offers' => $offers,
            'form' => $form->createView(),
        ]);
    }

    // AJAX ENDPOINT: Create new offer (called from modal)
    #[Route('/offers/new', name: 'offer_new', methods: ['POST'])]
    public function new(Request $request, EntityManagerInterface $entityManager): JsonResponse
    {
        $this->denyAccessUnlessGranted('ROLE_RECRUITER');

        $offer = new Offer();
        $form = $this->createForm(OfferType::class, $offer);
        $form->handleRequest($request);

        if ($form->isSubmitted() && $form->isValid()) {
            $offer->setRecruiter($this->getUser());
            $entityManager->persist($offer);
            $entityManager->flush();

            return new JsonResponse([
                'success' => true,
                'message' => 'Offer created successfully!',
                'offer' => [
                    'id' => $offer->getId(),
                    'title' => $offer->getTitle(),
                    'description' => $offer->getDescription(),
                    'skills' => $offer->getSkills(),
                    'location' => $offer->getLocation(),
                    'salary' => $offer->getSalary(),
                    'contractType' => $offer->getContractType(),
                    'createdAt' => $offer->getCreatedAt()->format('Y-m-d'),
                    'applicationsCount' => $offer->getApplications()->count(),
                ]
            ]);
        }

        // Return form errors
        $errors = [];
        foreach ($form->getErrors(true) as $error) {
            $errors[] = $error->getMessage();
        }

        // Return field-specific errors if available
        if (empty($errors)) {
            foreach ($form as $child) {
                if (!$child->isValid()) {
                    foreach ($child->getErrors() as $error) {
                        $errors[] = $error->getMessage();
                    }
                }
            }
        }

        // failure response
        return new JsonResponse([
            'success' => false,
            'errors' => $errors ?: ['Form submission failed']
        ], 400);
    }

    // AJAX ENDPOINT: Get offer data for edit modal
    #[Route('/offers/{id}/edit', name: 'offer_edit', methods: ['GET'])]
    public function edit(Offer $offer): JsonResponse
    {
        // Security check
        if ($offer->getRecruiter() !== $this->getUser()) {
            return new JsonResponse([
                'success' => false,
                'error' => 'Access denied'
            ], 403);
        }

        return new JsonResponse([
            'success' => true,
            'offer' => [
                'id' => $offer->getId(),
                'title' => $offer->getTitle(),
                'description' => $offer->getDescription(),
                'skills' => $offer->getSkills(),
                'location' => $offer->getLocation(),
                'salary' => $offer->getSalary(),
                'contractType' => $offer->getContractType(),
            ]
        ]);
    }

    // AJAX ENDPOINT: Update offer (called from edit modal)
    #[Route('/offers/{id}/update', name: 'offer_update', methods: ['PUT'])]
    public function update(Request $request, Offer $offer, EntityManagerInterface $entityManager): JsonResponse
    {
        // Security check
        if ($offer->getRecruiter() !== $this->getUser()) {
            return new JsonResponse([
                'success' => false,
                'error' => 'Access denied'
            ], 403);
        }

        // Parse JSON data from AJAX request
        $data = json_decode($request->getContent(), true);

        // Validate required fields
        if (empty($data['title'])) {
            return new JsonResponse([
                'success' => false,
                'error' => 'Title is required'
            ], 400);
        }

        if (empty($data['description'])) {
            return new JsonResponse([
                'success' => false,
                'error' => 'Description is required'
            ], 400);
        }

        if (empty($data['skills'])) {
            return new JsonResponse([
                'success' => false,
                'error' => 'Skills are required'
            ], 400);
        }

        // Manual update since we're not using form in AJAX
        $offer->setTitle($data['title']);
        $offer->setDescription($data['description']);
        $offer->setSkills($data['skills']);
        $offer->setLocation($data['location'] ?? $offer->getLocation());
        $offer->setSalary($data['salary'] ?? $offer->getSalary());
        $offer->setContractType($data['contractType'] ?? $offer->getContractType());

        $entityManager->flush();

        return new JsonResponse([
            'success' => true,
            'message' => 'Offer updated successfully!',
            'offer' => [
                'id' => $offer->getId(),
                'title' => $offer->getTitle(),
                'description' => $offer->getDescription(),
                'skills' => $offer->getSkills(),
                'location' => $offer->getLocation(),
                'salary' => $offer->getSalary(),
                'contractType' => $offer->getContractType(),
            ]
        ]);
    }

    // AJAX ENDPOINT: Delete offer with applications handling
    #[Route('/offers/{id}/delete', name: 'offer_delete', methods: ['DELETE'])]
    public function delete(Request $request, Offer $offer, EntityManagerInterface $entityManager, LoggerInterface $logger): JsonResponse
    {
        try {
            // Security check
            if ($offer->getRecruiter() !== $this->getUser()) {
                return new JsonResponse([
                    'success' => false,
                    'error' => 'Access denied. You can only delete your own offers.'
                ], 403);
            }

            $hasApplications = $offer->getApplications()->count() > 0;
            $deleteMode = $request->query->get('deleteMode', 'offer_only');

            // Check if user wants to delete with applications
            if ($hasApplications && $deleteMode === 'offer_only') {
                return new JsonResponse([
                    'success' => false,
                    'error' => 'Cannot delete offer because it has ' . $offer->getApplications()->count() . ' application(s).',
                    'hasApplications' => true,
                    'applicationsCount' => $offer->getApplications()->count(),
                    'message' => 'Please delete applications first or use "Delete with Applications" option.'
                ], 400);
            }

            // Delete applications if requested
            if ($hasApplications && $deleteMode === 'with_applications') {
                $applications = $offer->getApplications();
                foreach ($applications as $application) {
                    $entityManager->remove($application);
                }
            }

            $entityManager->remove($offer);
            $entityManager->flush();

            return new JsonResponse([
                'success' => true,
                'message' => $hasApplications
                    ? 'Offer and all related applications deleted successfully!'
                    : 'Offer deleted successfully!'
            ]);

        } catch (\Exception $e) {
            $logger->error('Delete offer error: ' . $e->getMessage(), [
                'exception' => $e,
                'offer_id' => $offer->getId(),
                'user_id' => $this->getUser()->getId()
            ]);

            return new JsonResponse([
                'success' => false,
                'error' => 'An error occurred while deleting the offer: ' . $e->getMessage()
            ], 500);
        }
    }

    // AJAX ENDPOINT: Get offer details for show modal
    #[Route('/offers/{id}/show', name: 'offer_show', methods: ['GET'])]
    public function show(Offer $offer): JsonResponse
    {
        return new JsonResponse([
            'success' => true,
            'offer' => [
                'id' => $offer->getId(),
                'title' => $offer->getTitle(),
                'description' => $offer->getDescription(),
                'skills' => $offer->getSkills(),
                'location' => $offer->getLocation() ?? 'Not specified',
                'salary' => $offer->getSalary() ?? 'Not specified',
                'contractType' => $offer->getContractType() ?? 'Full-time',
                'createdAt' => $offer->getCreatedAt()->format('F d, Y'),
                'recruiter' => $offer->getRecruiter()->getFullName(),
                'applicationsCount' => $offer->getApplications()->count(),
            ]
        ]);
    }

    // AJAX ENDPOINT: Search and filter offers
    #[Route('/offers/search', name: 'offer_search', methods: ['GET'])]
    public function search(Request $request, OfferRepository $offerRepository): JsonResponse
    {
        $searchTerm = $request->query->get('q', '');
        $skills = $request->query->get('skills', '');
        $page = (int) $request->query->get('page', 1);
        $limit = (int) $request->query->get('limit', 10);

        $user = $this->getUser();

        if ($this->isGranted('ROLE_RECRUITER')) {
            $result = $offerRepository->searchForRecruiter($user, $searchTerm, $skills, $page, $limit);
        } else {
            $result = $offerRepository->search($searchTerm, $skills, $page, $limit);
        }

        $offersData = [];
        foreach ($result['offers'] as $offer) {
            $offersData[] = [
                'id' => $offer->getId(),
                'title' => $offer->getTitle(),
                'description' => $offer->getDescription(),
                'skills' => $offer->getSkills(),
                'location' => $offer->getLocation(),
                'salary' => $offer->getSalary(),
                'contractType' => $offer->getContractType(),
                'createdAt' => $offer->getCreatedAt()->format('M d, Y'),
                'applicationsCount' => $offer->getApplications()->count(),
            ];
        }

        return new JsonResponse([
            'success' => true,
            'offers' => $offersData,
            'pagination' => [
                'total' => $result['total'],
                'page' => $result['page'],
                'limit' => $result['limit'],
                'totalPages' => $result['totalPages']
            ]
        ]);
    }
}


==========================================================================================
FILE: src\Controller\ProfileController.php
==========================================================================================

<?php

namespace App\Controller;

use App\Entity\User;
use App\Form\ProfileFormType;
use Doctrine\ORM\EntityManagerInterface;
use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\Routing\Attribute\Route;
use Symfony\Component\Security\Core\Authentication\Token\Storage\TokenStorageInterface;

final class ProfileController extends AbstractController
{
    #[Route('/profile', name: 'profile_edit', methods: ['GET', 'POST'])]
    public function edit(Request $request, EntityManagerInterface $entityManager): Response
    {
        /** @var User $user */
        $user = $this->getUser();

        $form = $this->createForm(ProfileFormType::class, $user);
        $form->handleRequest($request);

        if ($form->isSubmitted() && $form->isValid()) {
            $entityManager->flush();

            $this->addFlash('success', '✅ Your profile has been updated successfully!');

            // Redirect to avoid form resubmission
            return $this->redirectToRoute('profile_edit');
        }

        return $this->render('profile/index.html.twig', [
            'profileForm' => $form->createView(),
            'user' => $user,
        ]);
    }

    #[Route('/profile/delete', name: 'profile_delete', methods: ['POST'])]
    public function deleteAccount(
        Request $request,
        EntityManagerInterface $entityManager,
        TokenStorageInterface $tokenStorage
    ): Response {
        /** @var User $user */
        $user = $this->getUser();

        // Verify CSRF token for security
        $submittedToken = $request->request->get('_token');
        if (!$this->isCsrfTokenValid('delete-account', $submittedToken)) {
            $this->addFlash('error', 'Invalid security token. Please try again.');
            return $this->redirectToRoute('profile_edit');
        }

        try {
            // First, log out the user
            $tokenStorage->setToken(null);
            $request->getSession()->invalidate();

            // Then delete the user
            $entityManager->remove($user);
            $entityManager->flush();

            $this->addFlash('success', 'Your account has been deleted successfully. We hope to see you again!');
            return $this->redirectToRoute('app_home');
        } catch (\Exception $e) {
            $this->addFlash('error', 'An error occurred while deleting your account. Please try again.');
            return $this->redirectToRoute('profile_edit');
        }
    }
}


==========================================================================================
FILE: src\Controller\RecruiterDashboardController.php
==========================================================================================

<?php

namespace App\Controller;

use App\Repository\ApplicationRepository;
use App\Repository\OfferRepository;
use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\Routing\Attribute\Route;

final class RecruiterDashboardController extends AbstractController
{
    #[Route('/recruiter/dashboard', name: 'recruiter_dashboard')]
    public function index(OfferRepository $offerRepository,ApplicationRepository $applicationRepository): Response
    {
        $this->denyAccessUnlessGranted('ROLE_RECRUITER');

        $user = $this->getUser();

        $offers = $offerRepository->findBy(
            ['recruiter' => $user],
            ['createdAt' => 'DESC'],
        );
        $allApplications = [];
        $stats = [
            'total_offers' => count($offers),
            'total_applications' => 0,
            'pending' => 0,
            'accepted' => 0,
            'rejected' => 0,
        ];
        foreach($offers as $offer){
            $applications = $applicationRepository->findBy(
                ['offer' => $offer],
                ['createdAt' => 'DESC'],
            );
            $allApplications = array_merge($allApplications,$applications);
            foreach($applications as $app){
                $stats['total_applications']++;
                $status = strtolower($app->getStatus());
                        if (isset($stats[$status])) {
                    $stats[$status]++;
                }
            }
        }
        return $this->render('recruiter_dashboard/index.html.twig', [
            'offers' => $offers,
            'applications' => $allApplications,
            'stats' => $stats,
        ]);
    }
}


==========================================================================================
FILE: src\Controller\RegistrationController.php
==========================================================================================

<?php

namespace App\Controller;

use App\Entity\User;
use App\Form\RegistrationFormType;
use App\Security\AppCustomAuthenticator;
use Doctrine\ORM\EntityManagerInterface;
use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;
use Symfony\Bundle\SecurityBundle\Security;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\PasswordHasher\Hasher\UserPasswordHasherInterface;
use Symfony\Component\Routing\Attribute\Route;

class RegistrationController extends AbstractController
{
    #[Route('/register', name: 'app_register')]
    public function register(Request $request, UserPasswordHasherInterface $userPasswordHasher, Security $security, EntityManagerInterface $entityManager): Response
    {
        $user = new User();
        $form = $this->createForm(RegistrationFormType::class, $user);
        $form->handleRequest($request);

        if ($form->isSubmitted() && $form->isValid()) {
            $user->setRoles(['ROLE_CANDIDATE']);

            // encode the plain password
            $user->setPassword($userPasswordHasher->hashPassword($user, $form->get('plainPassword')->getData()));

            $entityManager->persist($user);
            $entityManager->flush();

            // do anything else you need here, like send an email

            return $security->login($user, AppCustomAuthenticator::class, 'main');
        }

        return $this->render('registration/register.html.twig', [
            'registrationForm' => $form->createView(),
        ]);
    }
}


==========================================================================================
FILE: src\Controller\SecurityController.php
==========================================================================================

<?php

namespace App\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\Routing\Attribute\Route;
use Symfony\Component\Security\Http\Authentication\AuthenticationUtils;

class SecurityController extends AbstractController
{
    #[Route(path: '/login', name: 'app_login')]
    public function login(AuthenticationUtils $authenticationUtils): Response
    {
        // if ($this->getUser()) {
        //     return $this->redirectToRoute('target_path');
        // }

        // get the login error if there is one
        $error = $authenticationUtils->getLastAuthenticationError();
        // last username entered by the user
        $lastUsername = $authenticationUtils->getLastUsername();

        return $this->render('security/login.html.twig', ['last_username' => $lastUsername, 'error' => $error]);
    }

    #[Route(path: '/logout', name: 'app_logout')]
    public function logout(): void
    {
        throw new \LogicException('This method can be blank - it will be intercepted by the logout key on your firewall.');
    }
}


==========================================================================================
FOLDER: src/Entity
==========================================================================================


==========================================================================================
FILE: src\Entity\Application.php
==========================================================================================

<?php

namespace App\Entity;

use App\Repository\ApplicationRepository;
use Doctrine\DBAL\Types\Types;
use Doctrine\ORM\Mapping as ORM;

#[ORM\Entity(repositoryClass: ApplicationRepository::class)]
class Application
{
    public const STATUS_PENDING = "PENDING";
    public const STATUS_ACCEPTED = "ACCEPTED";
    public const STATUS_REJECTED = "REJECTED";

    #[ORM\Id]
    #[ORM\GeneratedValue]
    #[ORM\Column]

    private ?int $id = null;

    #[ORM\Column(length: 255)]
    private ?string $resume = null;

    #[ORM\Column(type: Types::TEXT)]
    private ?string $coverLetter = null;

    #[ORM\Column(length: 20)]
    private ?string $status = "PENDING";

    #[ORM\Column]
    private ?\DateTimeImmutable $createdAt = null;

    #[ORM\Column(type: Types::TEXT, nullable: true)]
    private ?string $notes = null;
    // relations
    #[ORM\ManyToOne]
    #[ORM\JoinColumn(nullable: false)]
    private ?User $candidate = null;

    #[ORM\ManyToOne(inversedBy: 'applications')]
    #[ORM\JoinColumn(nullable: false)]
    private ?Offer $offer = null;

    public function getId(): ?int
    {
        return $this->id;
    }

    public function getResume(): ?string
    {
        return $this->resume;
    }

    public function setResume(string $resume): static
    {
        $this->resume = $resume;

        return $this;
    }

    public function getCoverLetter(): ?string
    {
        return $this->coverLetter;
    }

    public function setCoverLetter(string $coverLetter): static
    {
        $this->coverLetter = $coverLetter;

        return $this;
    }

    public function getStatus(): ?string
    {
        return $this->status;
    }

    public function setStatus(string $status): static
    {
        $this->status = $status;

        return $this;
    }

    public function getCreatedAt(): ?\DateTimeImmutable
    {
        return $this->createdAt;
    }

    public function setCreatedAt(\DateTimeImmutable $createdAt): static
    {
        $this->createdAt = $createdAt;

        return $this;
    }

    public function getNotes(): ?string
    {
        return $this->notes;
    }

    public function setNotes(?string $notes): static
    {
        $this->notes = $notes;

        return $this;
    }

    public function getCandidate(): ?User
    {
        return $this->candidate;
    }

    public function setCandidate(?User $candidate): static
    {
        $this->candidate = $candidate;

        return $this;
    }

    public function getOffer(): ?Offer
    {
        return $this->offer;
    }

    public function setOffer(?Offer $offer): static
    {
        $this->offer = $offer;

        return $this;
    }

    public function __construct()
    {
        $this->createdAt = new \DateTimeImmutable();
        $this->status = self::STATUS_PENDING;
    }
    public function getResumePath(): ?string
    {
        if ($this->resume) {
            return '/uploads/resumes/' . $this->resume;
        }
        return null;
    }

    public function getStatusBadgeClass(): string
    {
        switch ($this->status) {
            case self::STATUS_ACCEPTED:
                return 'bg-success';
            case self::STATUS_REJECTED:
                return 'bg-danger';
            default:
                return 'bg-warning';
        }
    }

    public function getStatusText(): string
    {
        switch ($this->status) {
            case self::STATUS_ACCEPTED:
                return 'Accepted';
            case self::STATUS_REJECTED:
                return 'Rejected';
            default:
                return 'Pending';
        }
    }
}


==========================================================================================
FILE: src\Entity\Offer.php
==========================================================================================

<?php

namespace App\Entity;

use App\Repository\OfferRepository;
use Doctrine\Common\Collections\ArrayCollection;
use Doctrine\Common\Collections\Collection;
use Doctrine\DBAL\Types\Types;
use Doctrine\ORM\Mapping as ORM;

#[ORM\Entity(repositoryClass: OfferRepository::class)]
#[ORM\HasLifecycleCallbacks]
class Offer
{
    #[ORM\Id]
    #[ORM\GeneratedValue]
    #[ORM\Column]
    // columns
    private ?int $id = null;

    #[ORM\Column(length: 255)]
    private ?string $title = null;

    #[ORM\Column(type: Types::TEXT)]
    private ?string $description = null;

    #[ORM\Column(type: Types::TEXT)]
    private ?string $skills = null;

    #[ORM\Column(length: 100, nullable: true)]
    private ?string $location = null;

    #[ORM\Column(length: 50, nullable: true)]
    private ?string $salary = null;

    #[ORM\Column(length: 50, nullable: true)]
    private ?string $contractType = null;

    #[ORM\Column]
    private ?\DateTimeImmutable $createdAt = null;

    // relations
    #[ORM\ManyToOne(inversedBy: 'offers')]
    #[ORM\JoinColumn(nullable:false)]
    private ?User $recruiter = null;

    /**
     * @var Collection<int, Application>
     */
    #[ORM\OneToMany(targetEntity: Application::class, mappedBy: 'offer')]
    private Collection $applications;

    // constructor
    public function __construct()
    {
        $this->applications = new ArrayCollection();
    }

    // getters et setters

    public function getId(): ?int
    {
        return $this->id;
    }

    public function getTitle(): ?string
    {
        return $this->title;
    }

    public function setTitle(string $title): static
    {
        $this->title = $title;

        return $this;
    }

    public function getDescription(): ?string
    {
        return $this->description;
    }

    public function setDescription(string $description): static
    {
        $this->description = $description;

        return $this;
    }

    public function getSkills(): ?string
    {
        return $this->skills;
    }

    public function setSkills(string $skills): static
    {
        $this->skills = $skills;

        return $this;
    }

    public function getLocation(): ?string
    {
        return $this->location;
    }

    public function setLocation(?string $location): static
    {
        $this->location = $location;

        return $this;
    }

    public function getSalary(): ?string
    {
        return $this->salary;
    }

    public function setSalary(?string $salary): static
    {
        $this->salary = $salary;

        return $this;
    }

    public function getContractType(): ?string
    {
        return $this->contractType;
    }

    public function setContractType(?string $contractType): static
    {
        $this->contractType = $contractType;

        return $this;
    }

    public function getCreatedAt(): ?\DateTimeImmutable
    {
        return $this->createdAt;
    }

    public function setCreatedAt(\DateTimeImmutable $createdAt): static
    {
        $this->createdAt = $createdAt;

        return $this;
    }

    public function getRecruiter(): ?User
    {
        return $this->recruiter;
    }

    public function setRecruiter(?User $recruiter): static
    {
        $this->recruiter = $recruiter;

        return $this;
    }

    /**
     * @return Collection<int, Application>
     */
    public function getApplications(): Collection
    {
        return $this->applications;
    }

    public function addApplication(Application $application): static
    {
        if (!$this->applications->contains($application)) {
            $this->applications->add($application);
            $application->setOffer($this);
        }

        return $this;
    }

    public function removeApplication(Application $application): static
    {
        if ($this->applications->removeElement($application)) {
            // set the owning side to null (unless already changed)
            if ($application->getOffer() === $this) {
                $application->setOffer(null);
            }
        }

        return $this;
    }
    #[ORM\PrePersist]
    public function setCreatedAtValue():void{
        $this->createdAt = new \DateTimeImmutable();
    }
}


==========================================================================================
FILE: src\Entity\User.php
==========================================================================================

<?php

namespace App\Entity;

use App\Repository\UserRepository;
use Doctrine\Common\Collections\ArrayCollection;
use Doctrine\Common\Collections\Collection;
use Doctrine\ORM\Mapping as ORM;
use Symfony\Bridge\Doctrine\Validator\Constraints\UniqueEntity;
use Symfony\Component\Security\Core\User\PasswordAuthenticatedUserInterface;
use Symfony\Component\Security\Core\User\UserInterface;

#[ORM\Entity(repositoryClass: UserRepository::class)]
#[ORM\UniqueConstraint(name: 'UNIQ_IDENTIFIER_EMAIL', fields: ['email'])]
#[UniqueEntity(fields: ['email'], message: 'There is already an account with this email')]
class User implements UserInterface, PasswordAuthenticatedUserInterface
{
    #[ORM\Id]
    #[ORM\GeneratedValue]
    #[ORM\Column]
    private ?int $id = null;

    #[ORM\Column(length: 180)]
    private ?string $email = null;

    /**
     * @var list<string> The user roles
     */
    #[ORM\Column]
    private array $roles = [];

    /**
     * @var string The hashed password
     */
    #[ORM\Column]
    private ?string $password = null;

    #[ORM\Column(length: 255)]
    private ?string $fullName = null;

    #[ORM\Column(length: 20, nullable: true)]
    private ?string $phone = null;


    #[ORM\Column]
    private ?\DateTimeImmutable $createdAt = null;



    /**
     * @var Collection<int, Offer>
     */
    #[ORM\OneToMany(targetEntity: Offer::class, mappedBy: 'recruiter')]
    private Collection $offers;

    public function __construct()
    {
        $this->offers = new ArrayCollection();
        $this->createdAt = new \DateTimeImmutable();
    }

    public function getId(): ?int
    {
        return $this->id;
    }

    public function getEmail(): ?string
    {
        return $this->email;
    }

    public function setEmail(string $email): static
    {
        $this->email = $email;

        return $this;
    }

    /**
     * A visual identifier that represents this user.
     *
     * @see UserInterface
     */
    public function getUserIdentifier(): string
    {
        return (string) $this->email;
    }

    /**
     * @see UserInterface
     */
    public function getRoles(): array
    {
        $roles = $this->roles;
        // guarantee every user at least has ROLE_USER
        $roles[] = 'ROLE_USER';

        return array_unique($roles);
    }

    /**
     * @param list<string> $roles
     */
    public function setRoles(array $roles): static
    {
        $this->roles = $roles;

        return $this;
    }

    /**
     * @see PasswordAuthenticatedUserInterface
     */
    public function getPassword(): ?string
    {
        return $this->password;
    }

    public function setPassword(string $password): static
    {
        $this->password = $password;

        return $this;
    }

    /**
     * Ensure the session doesn't contain actual password hashes by CRC32C-hashing them, as supported since Symfony 7.3.
     */
    public function __serialize(): array
    {
        $data = (array) $this;
        $data["\0" . self::class . "\0password"] = hash('crc32c', $this->password);

        return $data;
    }

    public function getFullName(): ?string
    {
        return $this->fullName;
    }

    public function setFullName(string $fullName): static
    {
        $this->fullName = $fullName;

        return $this;
    }

    public function getPhone(): ?string
    {
        return $this->phone;
    }

    public function setPhone(?string $phone): static
    {
        $this->phone = $phone;

        return $this;
    }

    /**
     * @return Collection<int, Offer>
     */
    public function getOffers(): Collection
    {
        return $this->offers;
    }


    public function addOffer(Offer $offer): static
    {
        if (!$this->offers->contains($offer)) {
            $this->offers->add($offer);
            $offer->setRecruiter($this);
        }

        return $this;
    }

    public function removeOffer(Offer $offer): static
    {
        if ($this->offers->removeElement($offer)) {
            // set the owning side to null (unless already changed)
            if ($offer->getRecruiter() === $this) {
                $offer->setRecruiter(null);
            }
        }

        return $this;
    }
    public function getCreatedAt(): ?\DateTimeImmutable
    {
        return $this->createdAt;
    }

    public function setCreatedAt(\DateTimeImmutable $createdAt): static
    {
        $this->createdAt = $createdAt;

        return $this;
    }
}


==========================================================================================
FOLDER: src/Form
==========================================================================================


==========================================================================================
FILE: src\Form\OfferType.php
==========================================================================================

<?php
// App\Form\OfferType.php

namespace App\Form;

use App\Entity\Offer;
use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\Extension\Core\Type\TextType;
use Symfony\Component\Form\Extension\Core\Type\TextareaType;
use Symfony\Component\Form\Extension\Core\Type\ChoiceType;
use Symfony\Component\Form\FormBuilderInterface;
use Symfony\Component\OptionsResolver\OptionsResolver;

class OfferType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options): void
    {
        $builder
            ->add('title', TextType::class, [
                'label' => "Job Title",
                'attr' => [
                    'class' => 'form-control',
                    'placeholder' => 'Senior PHP Developer'
                ],
                'required' => true
            ])
            ->add('description', TextareaType::class, [
                'label' => 'Description',
                'attr' => [
                    'class' => 'form-control',
                    'rows' => 5
                ],
                'required' => true
            ])
            ->add('skills', TextareaType::class, [
                'label' => "Required Skills",
                'attr' => [
                    'class' => 'form-control',
                    'rows' => 3,
                    'placeholder' => 'PHP, Symfony, MySQL, JavaScript...'
                ],
                'required' => true
            ])
            ->add('location', TextType::class, [
                'label' => 'Location',
                'required' => false,
                'attr' => [
                    'class' => 'form-control',
                    'placeholder' => 'Remote, Paris, New York...'
                ]
            ])
            ->add('salary', TextType::class, [
                'label' => 'Salary',
                'required' => false,
                'attr' => [
                    'class' => 'form-control',
                    'placeholder' => '$60,000 - $80,000'
                ]
            ])
            ->add('contractType', ChoiceType::class, [
                'label' => 'Contract Type',
                'required' => false,
                'choices' => [
                    'Full-time' => 'Full-time',
                    'Part-time' => 'Part-time',
                    'Contract' => 'Contract',
                    'Remote' => 'Remote',
                    'Internship' => 'Internship'
                ],
                'attr' => ['class' => 'form-select'],
                'placeholder' => 'Select contract type'
            ]);

        // Removed createdAt and recruiter fields - they'll be set automatically
    }

    public function configureOptions(OptionsResolver $resolver): void
    {
        $resolver->setDefaults([
            'data_class' => Offer::class,
        ]);
    }
}


==========================================================================================
FILE: src\Form\ProfileFormType.php
==========================================================================================

<?php

namespace App\Form;

use App\Entity\User;
use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\Extension\Core\Type\EmailType;
use Symfony\Component\Form\Extension\Core\Type\TextType;
use Symfony\Component\Form\FormBuilderInterface;
use Symfony\Component\OptionsResolver\OptionsResolver;
use Symfony\Component\Validator\Constraints\Email;
use Symfony\Component\Validator\Constraints\Length;
use Symfony\Component\Validator\Constraints\NotBlank;

class ProfileFormType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options): void
    {
        $builder
            ->add('fullName', TextType::class, [
                'label' => 'Full Name',
                'attr' => [
                    'placeholder' => 'Enter your full name',
                    'class' => 'form-control'
                ],
                'constraints' => [
                    new NotBlank(message: 'Please enter your full name.'),
                    new Length(
                        min: 2,
                        max: 255,
                        minMessage: 'Your name should be at least {{ limit }} characters.',
                        maxMessage: 'Your name should not exceed {{ limit }} characters.',
                    ),
                ]
            ])
            ->add('email', EmailType::class, [
                'label' => 'Email Address',
                'attr' => [
                    'placeholder' => 'Enter your email address',
                    'class' => 'form-control'
                ],
                'constraints' => [
                    new NotBlank(message: 'Please enter your email.'),
                    new Email(message: 'Please enter a valid email address.'),
                ]
            ])
            ->add('phone', TextType::class, [
                'label' => 'Phone Number',
                'required' => false,
                'attr' => [
                    'placeholder' => 'Enter your phone number',
                    'class' => 'form-control'
                ],
                'constraints' => [
                    new Length(
                        max: 20,
                        maxMessage: 'Phone number should not exceed {{ limit }} characters.',
                    ),
                ]
            ]);
    }

    public function configureOptions(OptionsResolver $resolver): void
    {
        $resolver->setDefaults([
            'data_class' => User::class,
        ]);
    }
}


==========================================================================================
FILE: src\Form\RegistrationFormType.php
==========================================================================================

<?php

namespace App\Form;

use App\Entity\User;
use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\Extension\Core\Type\CheckboxType;
use Symfony\Component\Form\Extension\Core\Type\EmailType;
use Symfony\Component\Form\Extension\Core\Type\PasswordType;
use Symfony\Component\Form\Extension\Core\Type\TextType;
use Symfony\Component\Form\FormBuilderInterface;
use Symfony\Component\OptionsResolver\OptionsResolver;
use Symfony\Component\Validator\Constraints\IsTrue;
use Symfony\Component\Validator\Constraints\Length;
use Symfony\Component\Validator\Constraints\NotBlank;

class RegistrationFormType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options): void
    {
        $builder
            ->add('email', EmailType::class, [
                'label' => 'Email',
                'attr' => [
                    'placeholder' => 'Enter your email',
                    'class' => 'form-control'
                ],
                'constraints' => [
                    new NotBlank(message: 'Please enter your email'),
                ],
            ])
            ->add('fullName', TextType::class, [
                'label' => 'Full Name',
                'attr' => [
                    'placeholder' => 'Enter your full name',
                    'class' => 'form-control'
                ],
                'constraints' => [
                    new NotBlank(message: 'Please enter your full name'),
                ],
            ])
            ->add('phone', TextType::class, [
                'label' => 'Phone Number',
                'required' => false,
                'attr' => [
                    'placeholder' => 'Enter your phone number (optional)',
                    'class' => 'form-control'
                ],
            ])
            ->add('plainPassword', PasswordType::class, [
                'label' => 'Password',
                'mapped' => false,
                'attr' => [
                    'autocomplete' => 'new-password',
                    'placeholder' => 'Enter a password',
                    'class' => 'form-control'
                ],
                'constraints' => [
                    new NotBlank(message: 'Please enter a password'),
                    new Length(
                        min: 6,
                        minMessage: 'Your password should be at least {{ limit }} characters',
                        max: 4096,
                    ),
                ],
            ])
            ->add('agreeTerms', CheckboxType::class, [
                'label' => 'I agree to the terms and conditions',
                'mapped' => false,
                'constraints' => [
                    new IsTrue(message: 'You should agree to our terms.'),
                ],
            ]);
    }

    public function configureOptions(OptionsResolver $resolver): void
    {
        $resolver->setDefaults([
            'data_class' => User::class,
        ]);
    }
}


==========================================================================================
FOLDER: src/Repository
==========================================================================================


==========================================================================================
FILE: src\Repository\ApplicationRepository.php
==========================================================================================

<?php
// src/Repository/ApplicationRepository.php

namespace App\Repository;

use App\Entity\Application;
use App\Entity\User;
use Doctrine\Bundle\DoctrineBundle\Repository\ServiceEntityRepository;
use Doctrine\Persistence\ManagerRegistry;

/**
 * @extends ServiceEntityRepository<Application>
 */
class ApplicationRepository extends ServiceEntityRepository
{
    public function __construct(ManagerRegistry $registry)
    {
        parent::__construct($registry, Application::class);
    }

    // Find applications by recruiter (applications for their offers)
    public function findByRecruiter(User $recruiter): array
    {
        return $this->createQueryBuilder('a')
            ->innerJoin('a.offer', 'o')
            ->where('o.recruiter = :recruiter')
            ->setParameter('recruiter', $recruiter)
            ->orderBy('a.createdAt', 'DESC')
            ->getQuery()
            ->getResult();
    }

    // Search applications for recruiter
    public function searchForRecruiter(
        User $recruiter,
        string $searchTerm = '',
        string $status = '',
        ?int $offerId = null,
        int $page = 1,
        int $limit = 10
    ): array {
        $qb = $this->createQueryBuilder('a')
            ->innerJoin('a.offer', 'o')
            ->innerJoin('a.candidate', 'c')
            ->where('o.recruiter = :recruiter')
            ->setParameter('recruiter', $recruiter)
            ->orderBy('a.createdAt', 'DESC');

        if (!empty($searchTerm)) {
            $qb->andWhere('c.fullName LIKE :searchTerm OR c.email LIKE :searchTerm OR a.coverLetter LIKE :searchTerm')
               ->setParameter('searchTerm', '%' . $searchTerm . '%');
        }

        if (!empty($status)) {
            $qb->andWhere('a.status = :status')
               ->setParameter('status', $status);
        }

        if ($offerId) {
            $qb->andWhere('o.id = :offerId')
               ->setParameter('offerId', $offerId);
        }

        // Get total count
        $totalQb = clone $qb;
        $total = count($totalQb->getQuery()->getResult());

        // Apply pagination
        $qb->setFirstResult(($page - 1) * $limit)
           ->setMaxResults($limit);

        return [
            'applications' => $qb->getQuery()->getResult(),
            'total' => $total,
            'page' => $page,
            'limit' => $limit,
            'totalPages' => ceil($total / $limit)
        ];
    }

    // Search applications for candidate
    public function searchForCandidate(
        User $candidate,
        string $searchTerm = '',
        string $status = '',
        int $page = 1,
        int $limit = 10
    ): array {
        $qb = $this->createQueryBuilder('a')
            ->innerJoin('a.offer', 'o')
            ->where('a.candidate = :candidate')
            ->setParameter('candidate', $candidate)
            ->orderBy('a.createdAt', 'DESC');

        if (!empty($searchTerm)) {
            $qb->andWhere('o.title LIKE :searchTerm OR o.description LIKE :searchTerm OR a.coverLetter LIKE :searchTerm')
               ->setParameter('searchTerm', '%' . $searchTerm . '%');
        }

        if (!empty($status)) {
            $qb->andWhere('a.status = :status')
               ->setParameter('status', $status);
        }

        // Get total count
        $totalQb = clone $qb;
        $total = count($totalQb->getQuery()->getResult());

        // Apply pagination
        $qb->setFirstResult(($page - 1) * $limit)
           ->setMaxResults($limit);

        return [
            'applications' => $qb->getQuery()->getResult(),
            'total' => $total,
            'page' => $page,
            'limit' => $limit,
            'totalPages' => ceil($total / $limit)
        ];
    }

    // Get recruiter statistics
    public function getRecruiterStats(User $recruiter): array
    {
        $qb = $this->createQueryBuilder('a')
            ->select([
                'COUNT(a.id) as total',
                'SUM(CASE WHEN a.status = :pending THEN 1 ELSE 0 END) as pending',
                'SUM(CASE WHEN a.status = :accepted THEN 1 ELSE 0 END) as accepted',
                'SUM(CASE WHEN a.status = :rejected THEN 1 ELSE 0 END) as rejected',
            ])
            ->innerJoin('a.offer', 'o')
            ->where('o.recruiter = :recruiter')
            ->setParameters([
                'recruiter' => $recruiter,
                'pending' => Application::STATUS_PENDING,
                'accepted' => Application::STATUS_ACCEPTED,
                'rejected' => Application::STATUS_REJECTED,
            ]);

        $result = $qb->getQuery()->getSingleResult();

        return [
            'total' => (int) $result['total'],
            'pending' => (int) $result['pending'],
            'accepted' => (int) $result['accepted'],
            'rejected' => (int) $result['rejected'],
        ];
    }

    // Get candidate statistics
    public function getCandidateStats(User $candidate): array
    {
        $qb = $this->createQueryBuilder('a')
            ->select([
                'COUNT(a.id) as total',
                'SUM(CASE WHEN a.status = :pending THEN 1 ELSE 0 END) as pending',
                'SUM(CASE WHEN a.status = :accepted THEN 1 ELSE 0 END) as accepted',
                'SUM(CASE WHEN a.status = :rejected THEN 1 ELSE 0 END) as rejected',
            ])
            ->where('a.candidate = :candidate')
            ->setParameters([
                'candidate' => $candidate,
                'pending' => Application::STATUS_PENDING,
                'accepted' => Application::STATUS_ACCEPTED,
                'rejected' => Application::STATUS_REJECTED,
            ]);

        $result = $qb->getQuery()->getSingleResult();

        return [
            'total' => (int) $result['total'],
            'pending' => (int) $result['pending'],
            'accepted' => (int) $result['accepted'],
            'rejected' => (int) $result['rejected'],
        ];
    }

    // Get recent applications for recruiter
    public function findRecentForRecruiter(User $recruiter, int $limit = 5): array
    {
        return $this->createQueryBuilder('a')
            ->innerJoin('a.offer', 'o')
            ->where('o.recruiter = :recruiter')
            ->setParameter('recruiter', $recruiter)
            ->orderBy('a.createdAt', 'DESC')
            ->setMaxResults($limit)
            ->getQuery()
            ->getResult();
    }

    // Get recent applications for candidate
    public function findRecentForCandidate(User $candidate, int $limit = 5): array
    {
        return $this->createQueryBuilder('a')
            ->where('a.candidate = :candidate')
            ->setParameter('candidate', $candidate)
            ->orderBy('a.createdAt', 'DESC')
            ->setMaxResults($limit)
            ->getQuery()
            ->getResult();
    }
}


==========================================================================================
FILE: src\Repository\OfferRepository.php
==========================================================================================

<?php

namespace App\Repository;

use App\Entity\Offer;
use App\Entity\User;
use Doctrine\Bundle\DoctrineBundle\Repository\ServiceEntityRepository;
use Doctrine\Persistence\ManagerRegistry;

/**
 * @extends ServiceEntityRepository<Offer>
 */
class OfferRepository extends ServiceEntityRepository
{
    public function __construct(ManagerRegistry $registry)
    {
        parent::__construct($registry, Offer::class);
    }

     public function search(string $searchTerm = '', string $skills = '', int $page = 1, int $limit = 10): array
    {
        $qb = $this->createQueryBuilder('o')
            ->orderBy('o.createdAt', 'DESC');

        if (!empty($searchTerm)) {
            $qb->andWhere('o.title LIKE :searchTerm OR o.description LIKE :searchTerm')
               ->setParameter('searchTerm', '%' . $searchTerm . '%');
        }

        if (!empty($skills)) {
            $skillsArray = explode(',', $skills);
            foreach ($skillsArray as $index => $skill) {
                $skill = trim($skill);
                if (!empty($skill)) {
                    $qb->andWhere('o.skills LIKE :skill' . $index)
                       ->setParameter('skill' . $index, '%' . $skill . '%');
                }
            }
        }

        // Pagination
        $total = count($qb->getQuery()->getResult());
        $qb->setFirstResult(($page - 1) * $limit)
           ->setMaxResults($limit);

        return [
            'offers' => $qb->getQuery()->getResult(),
            'total' => $total,
            'page' => $page,
            'limit' => $limit,
            'totalPages' => ceil($total / $limit)
        ];
    }

    public function searchForRecruiter(User $recruiter, string $searchTerm = '', string $skills = '', int $page = 1, int $limit = 10): array
    {
        $qb = $this->createQueryBuilder('o')
            ->where('o.recruiter = :recruiter')
            ->setParameter('recruiter', $recruiter)
            ->orderBy('o.createdAt', 'DESC');

        if (!empty($searchTerm)) {
            $qb->andWhere('o.title LIKE :searchTerm OR o.description LIKE :searchTerm')
               ->setParameter('searchTerm', '%' . $searchTerm . '%');
        }

        if (!empty($skills)) {
            $skillsArray = explode(',', $skills);
            foreach ($skillsArray as $index => $skill) {
                $skill = trim($skill);
                if (!empty($skill)) {
                    $qb->andWhere('o.skills LIKE :skill' . $index)
                       ->setParameter('skill' . $index, '%' . $skill . '%');
                }
            }
        }

        // Pagination
        $total = count($qb->getQuery()->getResult());
        $qb->setFirstResult(($page - 1) * $limit)
           ->setMaxResults($limit);

        return [
            'offers' => $qb->getQuery()->getResult(),
            'total' => $total,
            'page' => $page,
            'limit' => $limit,
            'totalPages' => ceil($total / $limit)
        ];
    }


//    /**
//     * @return Offer[] Returns an array of Offer objects
//     */
//    public function findByExampleField($value): array
//    {
//        return $this->createQueryBuilder('o')
//            ->andWhere('o.exampleField = :val')
//            ->setParameter('val', $value)
//            ->orderBy('o.id', 'ASC')
//            ->setMaxResults(10)
//            ->getQuery()
//            ->getResult()
//        ;
//    }

//    public function findOneBySomeField($value): ?Offer
//    {
//        return $this->createQueryBuilder('o')
//            ->andWhere('o.exampleField = :val')
//            ->setParameter('val', $value)
//            ->getQuery()
//            ->getOneOrNullResult()
//        ;
//    }
}


==========================================================================================
FILE: src\Repository\UserRepository.php
==========================================================================================

<?php

namespace App\Repository;

use App\Entity\User;
use Doctrine\Bundle\DoctrineBundle\Repository\ServiceEntityRepository;
use Doctrine\Persistence\ManagerRegistry;
use Symfony\Component\Security\Core\Exception\UnsupportedUserException;
use Symfony\Component\Security\Core\User\PasswordAuthenticatedUserInterface;
use Symfony\Component\Security\Core\User\PasswordUpgraderInterface;

/**
 * @extends ServiceEntityRepository<User>
 */
class UserRepository extends ServiceEntityRepository implements PasswordUpgraderInterface
{
    public function __construct(ManagerRegistry $registry)
    {
        parent::__construct($registry, User::class);
    }

    /**
     * Used to upgrade (rehash) the user's password automatically over time.
     */
    public function upgradePassword(PasswordAuthenticatedUserInterface $user, string $newHashedPassword): void
    {
        if (!$user instanceof User) {
            throw new UnsupportedUserException(sprintf('Instances of "%s" are not supported.', $user::class));
        }

        $user->setPassword($newHashedPassword);
        $this->getEntityManager()->persist($user);
        $this->getEntityManager()->flush();
    }

//    /**
//     * @return User[] Returns an array of User objects
//     */
//    public function findByExampleField($value): array
//    {
//        return $this->createQueryBuilder('u')
//            ->andWhere('u.exampleField = :val')
//            ->setParameter('val', $value)
//            ->orderBy('u.id', 'ASC')
//            ->setMaxResults(10)
//            ->getQuery()
//            ->getResult()
//        ;
//    }

//    public function findOneBySomeField($value): ?User
//    {
//        return $this->createQueryBuilder('u')
//            ->andWhere('u.exampleField = :val')
//            ->setParameter('val', $value)
//            ->getQuery()
//            ->getOneOrNullResult()
//        ;
//    }
}


==========================================================================================
FOLDER: src/Security
==========================================================================================


==========================================================================================
FILE: src\Security\AppCustomAuthenticator.php
==========================================================================================

<?php

namespace App\Security;

use Symfony\Component\HttpFoundation\RedirectResponse;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\Routing\Generator\UrlGeneratorInterface;
use Symfony\Component\Security\Core\Authentication\Token\TokenInterface;
use Symfony\Component\Security\Http\Authenticator\AbstractLoginFormAuthenticator;
use Symfony\Component\Security\Http\Authenticator\Passport\Badge\CsrfTokenBadge;
use Symfony\Component\Security\Http\Authenticator\Passport\Badge\RememberMeBadge;
use Symfony\Component\Security\Http\Authenticator\Passport\Badge\UserBadge;
use Symfony\Component\Security\Http\Authenticator\Passport\Credentials\PasswordCredentials;
use Symfony\Component\Security\Http\Authenticator\Passport\Passport;
use Symfony\Component\Security\Http\SecurityRequestAttributes;
use Symfony\Component\Security\Http\Util\TargetPathTrait;

class AppCustomAuthenticator extends AbstractLoginFormAuthenticator
{
    use TargetPathTrait;

    public const LOGIN_ROUTE = 'app_login';

    public function __construct(private UrlGeneratorInterface $urlGenerator)
    {
    }

    public function authenticate(Request $request): Passport
    {
        $email = $request->getPayload()->getString('email');

        $request->getSession()->set(SecurityRequestAttributes::LAST_USERNAME, $email);

        return new Passport(
            new UserBadge($email),
            new PasswordCredentials($request->getPayload()->getString('password')),
            [
                new CsrfTokenBadge('authenticate', $request->getPayload()->getString('_csrf_token')),
                new RememberMeBadge(),
            ]
        );
    }

    public function onAuthenticationSuccess(Request $request, TokenInterface $token, string $firewallName): ?Response
    {
        $user = $token->getUser();
        if (in_array('ROLE_RECRUITER',$user->getRoles())){
            return new RedirectResponse($this->urlGenerator->generate('recruiter_dashboard'));
        }
        if (in_array('ROLE_CANDIDATE',$user->getRoles())){
            return new RedirectResponse($this->urlGenerator->generate('candidate_dashboard'));
        }
        return new RedirectResponse($this->urlGenerator->generate('app_homepage'));
    }

    protected function getLoginUrl(Request $request): string
    {
        return $this->urlGenerator->generate(self::LOGIN_ROUTE);
    }
}


==========================================================================================
FOLDER: migrations
==========================================================================================


==========================================================================================
FILE: migrations\Version20251225215813.php
==========================================================================================

<?php

declare(strict_types=1);

namespace DoctrineMigrations;

use Doctrine\DBAL\Schema\Schema;
use Doctrine\Migrations\AbstractMigration;

/**
 * Auto-generated Migration: Please modify to your needs!
 */
final class Version20251225215813 extends AbstractMigration
{
    public function getDescription(): string
    {
        return '';
    }

    public function up(Schema $schema): void
    {
        // this up() migration is auto-generated, please modify it to your needs
        $this->addSql('CREATE TABLE application (id INT AUTO_INCREMENT NOT NULL, resume VARCHAR(255) NOT NULL, cover_letter LONGTEXT NOT NULL, status VARCHAR(20) NOT NULL, created_at DATETIME NOT NULL, notes LONGTEXT DEFAULT NULL, candidate_id INT NOT NULL, offer_id INT NOT NULL, INDEX IDX_A45BDDC191BD8781 (candidate_id), INDEX IDX_A45BDDC153C674EE (offer_id), PRIMARY KEY (id)) DEFAULT CHARACTER SET utf8mb4');
        $this->addSql('CREATE TABLE offer (id INT AUTO_INCREMENT NOT NULL, title VARCHAR(255) NOT NULL, description LONGTEXT NOT NULL, skills LONGTEXT NOT NULL, location VARCHAR(100) DEFAULT NULL, salary VARCHAR(50) DEFAULT NULL, contract_type VARCHAR(50) DEFAULT NULL, created_at DATETIME NOT NULL, recruiter_id INT NOT NULL, INDEX IDX_29D6873E156BE243 (recruiter_id), PRIMARY KEY (id)) DEFAULT CHARACTER SET utf8mb4');
        $this->addSql('CREATE TABLE offre (id INT AUTO_INCREMENT NOT NULL, PRIMARY KEY (id)) DEFAULT CHARACTER SET utf8mb4');
        $this->addSql('CREATE TABLE user (id INT AUTO_INCREMENT NOT NULL, email VARCHAR(180) NOT NULL, roles JSON NOT NULL, password VARCHAR(255) NOT NULL, full_name VARCHAR(255) NOT NULL, phone VARCHAR(20) DEFAULT NULL, UNIQUE INDEX UNIQ_IDENTIFIER_EMAIL (email), PRIMARY KEY (id)) DEFAULT CHARACTER SET utf8mb4');
        $this->addSql('ALTER TABLE application ADD CONSTRAINT FK_A45BDDC191BD8781 FOREIGN KEY (candidate_id) REFERENCES user (id)');
        $this->addSql('ALTER TABLE application ADD CONSTRAINT FK_A45BDDC153C674EE FOREIGN KEY (offer_id) REFERENCES offer (id)');
        $this->addSql('ALTER TABLE offer ADD CONSTRAINT FK_29D6873E156BE243 FOREIGN KEY (recruiter_id) REFERENCES user (id)');
    }

    public function down(Schema $schema): void
    {
        // this down() migration is auto-generated, please modify it to your needs
        $this->addSql('ALTER TABLE application DROP FOREIGN KEY FK_A45BDDC191BD8781');
        $this->addSql('ALTER TABLE application DROP FOREIGN KEY FK_A45BDDC153C674EE');
        $this->addSql('ALTER TABLE offer DROP FOREIGN KEY FK_29D6873E156BE243');
        $this->addSql('DROP TABLE application');
        $this->addSql('DROP TABLE offer');
        $this->addSql('DROP TABLE offre');
        $this->addSql('DROP TABLE user');
    }
}


==========================================================================================
FOLDER: templates
==========================================================================================


==========================================================================================
FILE: templates\base.html.twig
==========================================================================================

<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>{% block title %}HireFlow - Recruitment System{% endblock %}</title>
        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
        <style>
            .sidebar {
                min-height: 100vh;
                position: sticky;
                top: 0;
            }
            .main-content {
                padding: 20px;
            }
            .active {
                font-weight: 600;
            }
            .stat-card {
                transition: transform 0.2s;
            }
            .stat-card:hover {
                transform: translateY(-5px);
            }
        </style>
        {% block stylesheets %}{% endblock %}
        {% block javascripts %}{% endblock %}
    </head>
    <body>
        <!-- Top Navigation Bar -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow">
            <div class="container-fluid">
                <a class="navbar-brand fw-bold" href="{{ path('candidate_dashboard') }}">
                    <img src="{{ asset('images/entreprise.png') }}" alt="Applications" class="me-2" style="width: 20px; height: 20px;"> <span class="ms-2">HireFlow</span>
                </a>

                <div class="navbar-nav ms-auto">
                    {% if app.user %}
                        <span class="navbar-text me-3 d-none d-md-block">
                            Welcome, <strong>{{ app.user.fullName }}</strong>
                        </span>
                        <a class="nav-link" href="{{ path('app_logout') }}">
                            <span class="d-none d-md-inline">Logout</span>
                            <span class="d-md-none"><img src="{{ asset('images/door.png') }}" alt="Applications" class="me-2" style="width: 20px; height: 20px;"></span>
                        </a>
                    {% else %}
                        <a class="nav-link" href="{{ path('app_login') }}">Login</a>
                        <a class="nav-link" href="{{ path('app_register') }}">Register</a>
                    {% endif %}
                </div>
            </div>
        </nav>

        <!-- Flash Messages -->
        <div class="container-fluid mt-3">
            {% for message in app.flashes('success') %}
                <div class="alert alert-success alert-dismissible fade show" role="alert">
                    ✅ {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            {% endfor %}

            {% for message in app.flashes('error') %}
                <div class="alert alert-danger alert-dismissible fade show" role="alert">
                    ❌ {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            {% endfor %}

            {% for message in app.flashes('warning') %}
                <div class="alert alert-warning alert-dismissible fade show" role="alert">
                    ⚠️ {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            {% endfor %}
        </div>

        <!-- Main Layout with Sidebar -->
        <div class="container-fluid">
            <div class="row">
                {% if app.user %}
                    <!-- Sidebar Column -->
                    <div class="col-md-3 col-lg-2 px-0 d-print-none">
                        {% if is_granted('ROLE_CANDIDATE') %}
                            {% include('components/_sidebar_candidate.html.twig') %}
                        {% elseif (is_granted('ROLE_RECRUITER')) %}
                            {% include('components/_sidebar_recruiter.html.twig') %}
                        {% endif %}
                    </div>

                    <!-- Main Content Column -->
                    <div class="col-md-9 col-lg-10">
                {% else %}
                    <!-- Full width for login/register pages -->
                    <div class="col-12">
                {% endif %}

                    {% block body %}{% endblock %}
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer mt-5 py-3 bg-light border-top">
            <div class="container-fluid text-center">
                <span class="text-muted">© 2025 HireFlow - Symfony Recruitment System | Module Project</span>
            </div>
        </footer>

        <!-- Bootstrap JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        {% block javascripts_body %}{% endblock %}
    </body>
</html>


==========================================================================================
FILE: templates\application\index.html.twig
==========================================================================================

{# templates/application/index.html.twig #}

{% extends 'base.html.twig' %}

{% block title %}
    {% if is_granted('ROLE_RECRUITER') %}
        Applications - HireFlow
    {% else %}
        My Applications - HireFlowa
    {% endif %}
{% endblock %}

{% block stylesheets %}
{{ parent() }}
<style>
    .table-container {
        background: white;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        overflow: hidden;
    }
    .table th {
        background-color: #f8f9fa;
        border-bottom: 2px solid #dee2e6;
        font-weight: 600;
        color: #495057;
    }
    .status-badge {
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 0.85rem;
        font-weight: 500;
    }
    .action-btn {
        padding: 5px 12px;
        font-size: 0.85rem;
        border-radius: 4px;
        margin: 2px;
    }
    .cover-letter-preview {
        max-height: 100px;
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
    }
    .modal-lg-custom {
        max-width: 900px;
    }
    .file-download-btn {
        background: #f8f9fa;
        border: 1px solid #dee2e6;
        padding: 8px 15px;
        border-radius: 4px;
        text-decoration: none;
        color: #495057;
        display: inline-flex;
        align-items: center;
        transition: all 0.2s;
    }
    .file-download-btn:hover {
        background: #e9ecef;
        color: #212529;
    }
</style>
{% endblock %}

{% block body %}
<div class="container-fluid">
    <!-- Page Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h1 class="h3 mb-0">
                {% if is_granted('ROLE_RECRUITER') %}
                    Applications
                {% else %}
                    My Applications
                {% endif %}
            </h1>
            <p class="text-muted mb-0">
                {% if is_granted('ROLE_RECRUITER') %}
                    Manage applications for your job offers
                {% else %}
                    Track your job applications
                {% endif %}
            </p>
        </div>
    </div>

    <!-- Statistics Cards -->
    <div class="row mb-4" id="statsCards">
        <!-- Stats will be loaded via JavaScript -->
    </div>

    <!-- Search and Filters -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-4">
                            <input type="text" class="form-control" id="searchInput"
                                   placeholder="Search by candidate name, email, or cover letter...">
                        </div>

                        {% if is_granted('ROLE_RECRUITER') %}
                        <div class="col-md-3">
                            <select class="form-select" id="offerFilter">
                                <option value="">All Offers</option>
                                {% for offer in offers %}
                                    <option value="{{ offer.id }}">{{ offer.title }} ({{ offer.applications|length }})</option>
                                {% endfor %}
                            </select>
                        </div>
                        {% endif %}

                        <div class="col-md-3">
                            <select class="form-select" id="statusFilter">
                                <option value="">All Status</option>
                                <option value="PENDING">Pending</option>
                                <option value="ACCEPTED">Accepted</option>
                                <option value="REJECTED">Rejected</option>
                            </select>
                        </div>

                        <div class="col-md-2">
                            <div class="d-flex gap-2">
                                <button class="btn btn-outline-primary w-100" onclick="performSearch()">
                                    <i class="bi bi-search"></i> Search
                                </button>
                                <button class="btn btn-outline-secondary" onclick="clearSearch()">
                                    <i class="bi bi-x-circle"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Applications Table -->
    <div class="table-container">
        <div class="table-responsive">
            <table class="table table-hover mb-0">
                <thead>
                    <tr>
                        {% if is_granted('ROLE_RECRUITER') %}
                            <th>Candidate</th>
                            <th>Email</th>
                        {% endif %}
                        <th>Job Offer</th>
                        <th>Cover Letter</th>
                        <th>Resume</th>
                        <th>Status</th>
                        <th>Applied Date</th>
                        <th class="text-center">Actions</th>
                    </tr>
                </thead>
                <tbody id="applicationsTableBody">
                    {% for application in applications %}
                    <tr id="application-{{ application.id }}">
                        {% if is_granted('ROLE_RECRUITER') %}
                            <td class="fw-semibold">{{ application.candidate.fullName }}</td>
                            <td>{{ application.candidate.email }}</td>
                        {% endif %}
                        <td>
                            <div class="fw-semibold">{{ application.offer.title }}</div>
                            <small class="text-muted">{{ application.offer.location|default('Remote') }}</small>
                        </td>
                        <td>
                            <div class="cover-letter-preview">
                                {{ application.coverLetter|slice(0, 100) }}...
                            </div>
                        </td>
                        <td>
                            {% if application.resume %}
                                <a href="{{ path('application_show', {'id': application.id}) }}"
                                   class="file-download-btn"
                                   onclick="event.preventDefault(); showApplicationDetails({{ application.id }})">
                                    <i class="bi bi-file-earmark-pdf me-2"></i>View CV
                                </a>
                            {% else %}
                                <span class="text-muted">No CV</span>
                            {% endif %}
                        </td>
                        <td>
                            <span class="status-badge {{ application.getStatusBadgeClass() }}">
                                {{ application.getStatusText() }}
                            </span>
                        </td>
                        <td>{{ application.createdAt|date('M d, Y') }}</td>
                        <td class="text-center">
                            <div class="btn-group btn-group-sm" role="group">
                                <!-- View Details Button (for both roles) -->
                                <button type="button" class="btn btn-outline-info action-btn"
                                        onclick="showApplicationDetails({{ application.id }})"
                                        title="View Details">
                                    <i class="bi bi-eye"></i>
                                </button>

                                {% if is_granted('ROLE_CANDIDATE') %}
                                    <!-- Edit Button (only for pending applications) -->
                                    {% if application.getStatus() == 'PENDING' %}
                                        <button type="button" class="btn btn-outline-primary action-btn"
                                                onclick="showEditApplicationModal({{ application.id }})"
                                                title="Edit Application">
                                            <i class="bi bi-pencil"></i>
                                        </button>
                                    {% endif %}

                                    <!-- Delete Button (only for pending applications) -->
                                    {% if application.getStatus() == 'PENDING' %}
                                        <button type="button" class="btn btn-outline-danger action-btn"
                                                onclick="deleteApplication({{ application.id }})"
                                                title="Delete Application">
                                            <i class="bi bi-trash"></i>
                                        </button>
                                    {% endif %}
                                {% endif %}

                                {% if is_granted('ROLE_RECRUITER') %}
                                    <!-- Accept Button -->
                                    <button type="button" class="btn btn-outline-success action-btn"
                                            onclick="updateApplicationStatus({{ application.id }}, 'ACCEPTED')"
                                            title="Accept Application"
                                            {% if application.getStatus() == 'ACCEPTED' %}disabled{% endif %}>
                                        <i class="bi bi-check-circle"></i>
                                    </button>

                                    <!-- Reject Button -->
                                    <button type="button" class="btn btn-outline-danger action-btn"
                                            onclick="updateApplicationStatus({{ application.id }}, 'REJECTED')"
                                            title="Reject Application"
                                            {% if application.getStatus() == 'REJECTED' %}disabled{% endif %}>
                                        <i class="bi bi-x-circle"></i>
                                    </button>

                                    <!-- Reset Button (if accepted or rejected) -->
                                    {% if application.getStatus() in ['ACCEPTED', 'REJECTED'] %}
                                        <button type="button" class="btn btn-outline-warning action-btn"
                                                onclick="updateApplicationStatus({{ application.id }}, 'PENDING')"
                                                title="Reset to Pending">
                                            <i class="bi bi-arrow-clockwise"></i>
                                        </button>
                                    {% endif %}
                                {% endif %}
                            </div>
                        </td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="{% if is_granted('ROLE_RECRUITER') %}8{% else %}6{% endif %}" class="text-center py-5">
                            <i class="bi bi-file-earmark-text" style="font-size: 3rem; color: #dee2e6;"></i>
                            <h5 class="text-muted mt-3">No applications found</h5>
                            {% if is_granted('ROLE_RECRUITER') %}
                                <p class="text-muted">Applications will appear here when candidates apply to your offers</p>
                            {% else %}
                                <p class="text-muted">You haven't applied to any job offers yet</p>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Pagination -->
    <div id="paginationContainer" class="mt-4"></div>
</div>

<!-- VIEW APPLICATION MODAL -->
<div class="modal fade" id="viewApplicationModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-lg-custom">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="viewApplicationTitle">Application Details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="d-flex flex-wrap gap-2 mb-3">
                            <span class="badge" id="viewApplicationStatus"></span>
                            <span class="badge bg-secondary">
                                <i class="bi bi-calendar me-1"></i><span id="viewApplicationDate"></span>
                            </span>
                        </div>
                    </div>
                </div>

                <div class="row mb-4">
                    <div class="col-md-6">
                        <h6 class="mb-2">Candidate Information</h6>
                        <div class="card">
                            <div class="card-body">
                                <p class="mb-1"><strong>Name:</strong> <span id="viewCandidateName"></span></p>
                                <p class="mb-1"><strong>Email:</strong> <span id="viewCandidateEmail"></span></p>
                                <p class="mb-0"><strong>Phone:</strong> <span id="viewCandidatePhone"></span></p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <h6 class="mb-2">Job Offer</h6>
                        <div class="card">
                            <div class="card-body">
                                <p class="mb-1"><strong>Position:</strong> <span id="viewOfferTitle"></span></p>
                                <p class="mb-0">
                                    <strong>Application ID:</strong> <span id="viewApplicationId"></span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mb-4">
                    <div class="col-12">
                        <h6 class="mb-2">Cover Letter</h6>
                        <div class="bg-light p-3 rounded" style="white-space: pre-wrap; line-height: 1.6;" id="viewCoverLetter"></div>
                    </div>
                </div>

                <div class="row mb-4">
                    <div class="col-12">
                        <h6 class="mb-2">Resume / CV</h6>
                        <div class="alert alert-info" id="viewResumeInfo">
                            <i class="bi bi-info-circle me-2"></i>
                            <span id="viewResumeText">No resume attached</span>
                        </div>
                        <a href="#" class="btn btn-primary" id="viewResumeLink" target="_blank" style="display: none;">
                            <i class="bi bi-download me-2"></i>Download Resume
                        </a>
                    </div>
                </div>

                {% if is_granted('ROLE_RECRUITER') %}
                <div class="row">
                    <div class="col-12">
                        <h6 class="mb-2">Quick Actions</h6>
                        <div class="d-flex gap-2" id="quickActions">
                            <!-- Actions will be populated dynamically -->
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<!-- EDIT APPLICATION MODAL -->
<div class="modal fade" id="editApplicationModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-lg-custom">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Edit Application</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="editApplicationForm">
                    <input type="hidden" id="editApplicationId">

                    <div class="row mb-3">
                        <div class="col-12">
                            <h6>Job Offer</h6>
                            <p class="fw-semibold" id="editApplicationOfferTitle"></p>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-12">
                            <label for="editCoverLetter" class="form-label">Cover Letter *</label>
                            <textarea class="form-control" id="editCoverLetter" rows="5" required></textarea>
                            <div class="invalid-feedback" id="editCoverLetterError"></div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-12">
                            <label for="editResumeFile" class="form-label">Resume / CV</label>
                            <input type="file" class="form-control" id="editResumeFile" accept=".pdf,.doc,.docx,.txt">
                            <small class="form-text text-muted">
                                Leave empty to keep current file. Allowed: PDF, DOC, DOCX, TXT (Max 5MB)
                            </small>
                            <div class="invalid-feedback" id="editResumeFileError"></div>
                        </div>
                    </div>

                    <div class="row mb-4">
                        <div class="col-12">
                            <div class="alert alert-info">
                                <i class="bi bi-info-circle me-2"></i>
                                You can only edit pending applications. Once accepted or rejected, applications cannot be modified.
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="updateApplication()">
                    <i class="bi bi-check-circle me-2"></i>Update Application
                </button>
            </div>
        </div>
    </div>
</div>

<!-- DELETE CONFIRMATION MODAL -->
<div class="modal fade" id="deleteApplicationModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title">
                    <i class="bi bi-exclamation-triangle me-2"></i>Delete Application
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this application?</p>
                <div class="alert alert-warning">
                    <i class="bi bi-exclamation-octagon me-2"></i>
                    <strong>This action cannot be undone.</strong> The application will be permanently deleted.
                </div>
                <p class="mb-0">This will remove:</p>
                <ul>
                    <li>Your cover letter</li>
                    <li>Your resume/CV file</li>
                    <li>Application history</li>
                </ul>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-danger" onclick="confirmDeleteApplication()">
                    <i class="bi bi-trash me-2"></i>Delete Application
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block javascripts_body %}
<script>
// Load stats on page load
document.addEventListener('DOMContentLoaded', function() {
    loadStats();
    createToastContainer();
});

// Load statistics
function loadStats() {
    fetch('/applications/stats')
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                renderStatsCards(data.stats);
            }
        });
}

function renderStatsCards(stats) {
    const container = document.getElementById('statsCards');

    if (!container) return;

    let cardsHtml = '';

    if (isRecruiter()) {
        cardsHtml = `
            <div class="col-md-3">
                <div class="card border-primary">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="flex-grow-1">
                                <h6 class="text-muted mb-1">Total Applications</h6>
                                <h4 class="mb-0">${stats.total || 0}</h4>
                            </div>
                            <div class="flex-shrink-0">
                                <i class="bi bi-files text-primary" style="font-size: 2rem;"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card border-warning">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="flex-grow-1">
                                <h6 class="text-muted mb-1">Pending</h6>
                                <h4 class="mb-0">${stats.pending || 0}</h4>
                            </div>
                            <div class="flex-shrink-0">
                                <i class="bi bi-clock text-warning" style="font-size: 2rem;"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card border-success">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="flex-grow-1">
                                <h6 class="text-muted mb-1">Accepted</h6>
                                <h4 class="mb-0">${stats.accepted || 0}</h4>
                            </div>
                            <div class="flex-shrink-0">
                                <i class="bi bi-check-circle text-success" style="font-size: 2rem;"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card border-danger">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="flex-grow-1">
                                <h6 class="text-muted mb-1">Rejected</h6>
                                <h4 class="mb-0">${stats.rejected || 0}</h4>
                            </div>
                            <div class="flex-shrink-0">
                                <i class="bi bi-x-circle text-danger" style="font-size: 2rem;"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;
    } else {
        cardsHtml = `
            <div class="col-md-3">
                <div class="card border-primary">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="flex-grow-1">
                                <h6 class="text-muted mb-1">Applied Jobs</h6>
                                <h4 class="mb-0">${stats.total || 0}</h4>
                            </div>
                            <div class="flex-shrink-0">
                                <i class="bi bi-briefcase text-primary" style="font-size: 2rem;"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card border-warning">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="flex-grow-1">
                                <h6 class="text-muted mb-1">Pending</h6>
                                <h4 class="mb-0">${stats.pending || 0}</h4>
                            </div>
                            <div class="flex-shrink-0">
                                <i class="bi bi-clock text-warning" style="font-size: 2rem;"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card border-success">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="flex-grow-1">
                                <h6 class="text-muted mb-1">Accepted</h6>
                                <h4 class="mb-0">${stats.accepted || 0}</h4>
                            </div>
                            <div class="flex-shrink-0">
                                <i class="bi bi-check-circle text-success" style="font-size: 2rem;"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card border-danger">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="flex-grow-1">
                                <h6 class="text-muted mb-1">Rejected</h6>
                                <h4 class="mb-0">${stats.rejected || 0}</h4>
                            </div>
                            <div class="flex-shrink-0">
                                <i class="bi bi-x-circle text-danger" style="font-size: 2rem;"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;
    }

    container.innerHTML = cardsHtml;
}

// Search functions
function performSearch() {
    const searchTerm = document.getElementById('searchInput').value;
    const statusFilter = document.getElementById('statusFilter').value;
    const offerFilter = document.getElementById('offerFilter') ? document.getElementById('offerFilter').value : '';

    let url = `/applications/search?q=${encodeURIComponent(searchTerm)}&status=${encodeURIComponent(statusFilter)}`;
    if (offerFilter) {
        url += `&offer=${offerFilter}`;
    }

    fetch(url)
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                updateTableWithSearchResults(data.applications);
                updatePagination(data.pagination.totalPages, data.pagination.page);
            } else {
                showToast('error', 'Search failed');
            }
        })
        .catch(error => {
            console.error('Search error:', error);
            showToast('error', 'Search error occurred');
        });
}

function clearSearch() {
    document.getElementById('searchInput').value = '';
    if (document.getElementById('statusFilter')) {
        document.getElementById('statusFilter').value = '';
    }
    if (document.getElementById('offerFilter')) {
        document.getElementById('offerFilter').value = '';
    }

    fetch('/applications/search?q=&status=')
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                updateTableWithSearchResults(data.applications);
                updatePagination(data.pagination.totalPages, data.pagination.page);
            }
        })
        .catch(error => {
            console.error('Clear search error:', error);
            location.reload();
        });
}

function updateTableWithSearchResults(applications) {
    const tbody = document.getElementById('applicationsTableBody');

    if (!applications || applications.length === 0) {
        tbody.innerHTML = `
            <tr>
                <td colspan="${isRecruiter() ? '8' : '6'}" class="text-center py-5">
                    <i class="bi bi-search" style="font-size: 3rem; color: #dee2e6;"></i>
                    <h5 class="text-muted mt-3">No matching applications found</h5>
                    <p class="text-muted">Try different search terms or filters</p>
                </td>
            </tr>
        `;
        return;
    }

    let html = '';
    applications.forEach(application => {
        const statusClass = getStatusClass(application.status);
        const statusText = getStatusText(application.status);
        const isPending = application.status === 'PENDING';
        const isAccepted = application.status === 'ACCEPTED';
        const isRejected = application.status === 'REJECTED';

        html += `
        <tr id="application-${application.id}">
            ${isRecruiter() ? `
                <td class="fw-semibold">${application.candidateName}</td>
                <td>${application.candidateEmail}</td>
            ` : ''}
            <td>
                <div class="fw-semibold">${application.offerTitle}</div>
                <small class="text-muted">Remote</small>
            </td>
            <td>
                <div class="cover-letter-preview">
                    ${application.coverLetter ? (application.coverLetter.length > 100 ? application.coverLetter.substring(0, 100) + '...' : application.coverLetter) : 'No cover letter'}
                </div>
            </td>
            <td>
                ${application.resume ? `
                    <a href="#" class="file-download-btn" onclick="event.preventDefault(); showApplicationDetails(${application.id})">
                        <i class="bi bi-file-earmark-pdf me-2"></i>View CV
                    </a>
                ` : '<span class="text-muted">No CV</span>'}
            </td>
            <td>
                <span class="status-badge ${statusClass}">
                    ${statusText}
                </span>
            </td>
            <td>${application.createdAt || ''}</td>
            <td class="text-center">
                <div class="btn-group btn-group-sm" role="group">
                    <button type="button" class="btn btn-outline-info action-btn"
                            onclick="showApplicationDetails(${application.id})"
                            title="View Details">
                        <i class="bi bi-eye"></i>
                    </button>

                    ${isRecruiter() ? `
                        <button type="button" class="btn btn-outline-success action-btn"
                                onclick="updateApplicationStatus(${application.id}, 'ACCEPTED')"
                                title="Accept Application"
                                ${isAccepted ? 'disabled' : ''}>
                            <i class="bi bi-check-circle"></i>
                        </button>
                        <button type="button" class="btn btn-outline-danger action-btn"
                                onclick="updateApplicationStatus(${application.id}, 'REJECTED')"
                                title="Reject Application"
                                ${isRejected ? 'disabled' : ''}>
                            <i class="bi bi-x-circle"></i>
                        </button>
                        ${isAccepted || isRejected ? `
                            <button type="button" class="btn btn-outline-warning action-btn"
                                    onclick="updateApplicationStatus(${application.id}, 'PENDING')"
                                    title="Reset to Pending">
                                <i class="bi bi-arrow-clockwise"></i>
                            </button>
                        ` : ''}
                    ` : `
                        ${isPending ? `
                            <button type="button" class="btn btn-outline-primary action-btn"
                                    onclick="showEditApplicationModal(${application.id})"
                                    title="Edit Application">
                                <i class="bi bi-pencil"></i>
                            </button>
                            <button type="button" class="btn btn-outline-danger action-btn"
                                    onclick="deleteApplication(${application.id})"
                                    title="Delete Application">
                                <i class="bi bi-trash"></i>
                            </button>
                        ` : ''}
                    `}
                </div>
            </td>
        </tr>
        `;
    });

    tbody.innerHTML = html;
}

function updatePagination(totalPages, currentPage) {
    const paginationContainer = document.getElementById('paginationContainer');
    if (!paginationContainer || totalPages <= 1) {
        if (paginationContainer) {
            paginationContainer.innerHTML = '';
        }
        return;
    }

    let html = '<nav><ul class="pagination justify-content-center">';

    // Previous button
    if (currentPage > 1) {
        html += `<li class="page-item">
                    <a class="page-link" href="#" onclick="loadPage(${currentPage - 1})">Previous</a>
                 </li>`;
    } else {
        html += `<li class="page-item disabled">
                    <span class="page-link">Previous</span>
                 </li>`;
    }

    // Page numbers
    const maxVisiblePages = 5;
    let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
    let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);

    if (endPage - startPage + 1 < maxVisiblePages) {
        startPage = Math.max(1, endPage - maxVisiblePages + 1);
    }

    for (let i = startPage; i <= endPage; i++) {
        if (i === currentPage) {
            html += `<li class="page-item active">
                        <span class="page-link">${i}</span>
                     </li>`;
        } else {
            html += `<li class="page-item">
                        <a class="page-link" href="#" onclick="loadPage(${i})">${i}</a>
                     </li>`;
        }
    }

    // Next button
    if (currentPage < totalPages) {
        html += `<li class="page-item">
                    <a class="page-link" href="#" onclick="loadPage(${currentPage + 1})">Next</a>
                 </li>`;
    } else {
        html += `<li class="page-item disabled">
                    <span class="page-link">Next</span>
                 </li>`;
    }

    html += '</ul></nav>';
    paginationContainer.innerHTML = html;
}

function loadPage(page) {
    const searchTerm = document.getElementById('searchInput')?.value || '';
    const statusFilter = document.getElementById('statusFilter')?.value || '';
    const offerFilter = document.getElementById('offerFilter') ? document.getElementById('offerFilter').value : '';

    let url = `/applications/search?q=${encodeURIComponent(searchTerm)}&status=${encodeURIComponent(statusFilter)}&page=${page}`;
    if (offerFilter) {
        url += `&offer=${offerFilter}`;
    }

    fetch(url)
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                updateTableWithSearchResults(data.applications);
                updatePagination(data.pagination.totalPages, page);
                document.querySelector('.table-container').scrollIntoView({ behavior: 'smooth' });
            }
        })
        .catch(error => {
            console.error('Page load error:', error);
            showToast('error', 'Error loading page');
        });
}

// Application CRUD functions
function showApplicationDetails(applicationId) {
    fetch(`/applications/${applicationId}/show`)
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const app = data.application;

                // Fill modal with data
                document.getElementById('viewApplicationId').textContent = app.id;
                document.getElementById('viewCandidateName').textContent = app.candidateName;
                document.getElementById('viewCandidateEmail').textContent = app.candidateEmail;
                document.getElementById('viewCandidatePhone').textContent = app.candidatePhone || 'Not provided';
                document.getElementById('viewOfferTitle').textContent = app.offerTitle;
                document.getElementById('viewCoverLetter').textContent = app.coverLetter || 'No cover letter provided';
                document.getElementById('viewApplicationDate').textContent = app.createdAt;

                // Set status badge
                const statusBadge = document.getElementById('viewApplicationStatus');
                statusBadge.textContent = app.statusText;
                statusBadge.className = 'badge ' + getStatusClass(app.status);

                // Handle resume
                const resumeLink = document.getElementById('viewResumeLink');
                const resumeText = document.getElementById('viewResumeText');
                const resumeInfo = document.getElementById('viewResumeInfo');

                if (app.resumePath) {
                    resumeText.textContent = 'Resume attached: ' + (app.resume || 'CV.pdf');
                    resumeLink.href = app.resumePath;
                    resumeLink.style.display = 'inline-block';
                    resumeInfo.className = 'alert alert-success';
                } else {
                    resumeText.textContent = 'No resume attached';
                    resumeLink.style.display = 'none';
                    resumeInfo.className = 'alert alert-info';
                }

                // Quick actions for recruiter
                if (isRecruiter()) {
                    const quickActions = document.getElementById('quickActions');
                    let actionsHtml = '';

                    if (app.status !== 'ACCEPTED') {
                        actionsHtml += `
                            <button type="button" class="btn btn-success"
                                    onclick="updateApplicationStatus(${app.id}, 'ACCEPTED');">
                                <i class="bi bi-check-circle me-2"></i>Accept Application
                            </button>
                        `;
                    }

                    if (app.status !== 'REJECTED') {
                        actionsHtml += `
                            <button type="button" class="btn btn-danger"
                                    onclick="updateApplicationStatus(${app.id}, 'REJECTED');">
                                <i class="bi bi-x-circle me-2"></i>Reject Application
                            </button>
                        `;
                    }

                    if (app.status === 'ACCEPTED' || app.status === 'REJECTED') {
                        actionsHtml += `
                            <button type="button" class="btn btn-warning"
                                    onclick="updateApplicationStatus(${app.id}, 'PENDING');">
                                <i class="bi bi-arrow-clockwise me-2"></i>Reset to Pending
                            </button>
                        `;
                    }

                    quickActions.innerHTML = actionsHtml;
                }

                // Show modal
                const modal = new bootstrap.Modal(document.getElementById('viewApplicationModal'));
                modal.show();
            }
        })
        .catch(error => {
            console.error('Error loading application:', error);
            showToast('error', 'Failed to load application details');
        });
}

function updateApplicationStatus(applicationId, status) {
    if (!confirm(`Are you sure you want to ${status.toLowerCase()} this application?`)) {
        return;
    }

    fetch(`/applications/${applicationId}/status`, {
        method: 'PUT',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ status: status })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            showToast('success', data.message);

            // Update status in table
            const statusCell = document.querySelector(`#application-${applicationId} td:nth-child(${isRecruiter() ? 6 : 4})`);
            if (statusCell) {
                const newClass = getStatusClass(data.application.status);
                const newText = getStatusText(data.application.status);
                statusCell.innerHTML = `<span class="status-badge ${newClass}">${newText}</span>`;
            }

            // Update action buttons
            const actionCell = document.querySelector(`#application-${applicationId} td:last-child .btn-group`);
            if (actionCell && isRecruiter()) {
                let buttonsHtml = `
                    <button type="button" class="btn btn-outline-info action-btn"
                            onclick="showApplicationDetails(${applicationId})"
                            title="View Details">
                        <i class="bi bi-eye"></i>
                    </button>
                `;

                if (data.application.status !== 'ACCEPTED') {
                    buttonsHtml += `
                        <button type="button" class="btn btn-outline-success action-btn"
                                onclick="updateApplicationStatus(${applicationId}, 'ACCEPTED')"
                                title="Accept Application">
                            <i class="bi bi-check-circle"></i>
                        </button>
                    `;
                }

                if (data.application.status !== 'REJECTED') {
                    buttonsHtml += `
                        <button type="button" class="btn btn-outline-danger action-btn"
                                onclick="updateApplicationStatus(${applicationId}, 'REJECTED')"
                                title="Reject Application">
                            <i class="bi bi-x-circle"></i>
                        </button>
                    `;
                }

                if (data.application.status === 'ACCEPTED' || data.application.status === 'REJECTED') {
                    buttonsHtml += `
                        <button type="button" class="btn btn-outline-warning action-btn"
                                onclick="updateApplicationStatus(${applicationId}, 'PENDING')"
                                title="Reset to Pending">
                            <i class="bi bi-arrow-clockwise"></i>
                        </button>
                    `;
                }

                actionCell.innerHTML = buttonsHtml;
            }

            // Reload stats
            loadStats();

        } else {
            showToast('error', data.error || 'Failed to update status');
        }
    })
    .catch(error => {
        console.error('Status update error:', error);
        showToast('error', 'Network error occurred');
    });
}

// Helper functions
function isRecruiter() {
    return document.body.classList.contains('role-recruiter') ||
           {% if is_granted('ROLE_RECRUITER') %}true{% else %}false{% endif %};
}

function getStatusClass(status) {
    switch(status) {
        case 'ACCEPTED': return 'bg-success';
        case 'REJECTED': return 'bg-danger';
        default: return 'bg-warning';
    }
}

function getStatusText(status) {
    switch(status) {
        case 'ACCEPTED': return 'Accepted';
        case 'REJECTED': return 'Rejected';
        default: return 'Pending';
    }
}

// Toast functions (reuse from offers page)
function showToast(type, message) {
    let container = document.getElementById('toastContainer');
    if (!container) {
        container = document.createElement('div');
        container.id = 'toastContainer';
        container.className = 'toast-container position-fixed bottom-0 end-0 p-3';
        container.style.zIndex = '1060';
        document.body.appendChild(container);
    }

    const toastId = 'toast-' + Date.now();
    const toast = document.createElement('div');
    toast.id = toastId;
    toast.className = `toast align-items-center text-white border-0`;

    if (type === 'error') {
        toast.classList.add('bg-danger');
    } else if (type === 'success') {
        toast.classList.add('bg-success');
    } else if (type === 'warning') {
        toast.classList.add('bg-warning');
    } else {
        toast.classList.add('bg-info');
    }

    toast.setAttribute('role', 'alert');
    toast.setAttribute('aria-live', 'assertive');
    toast.setAttribute('aria-atomic', 'true');

    toast.innerHTML = `
        <div class="d-flex">
            <div class="toast-body" style="color: white; font-weight: 500;">
                <i class="bi ${type === 'success' ? 'bi-check-circle' : type === 'error' ? 'bi-exclamation-circle' : 'bi-info-circle'} me-2"></i>
                ${message}
            </div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
    `;

    container.appendChild(toast);
    const bsToast = new bootstrap.Toast(toast, { delay: 3000 });
    bsToast.show();

    toast.addEventListener('hidden.bs.toast', () => toast.remove());
}

function createToastContainer() {
    let container = document.getElementById('toastContainer');
    if (!container) {
        container = document.createElement('div');
        container.id = 'toastContainer';
        container.className = 'toast-container position-fixed bottom-0 end-0 p-3';
        container.style.zIndex = '1060';
        document.body.appendChild(container);
    }
    return container;
}

// Add enter key support for search
document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.getElementById('searchInput');
    if (searchInput) {
        searchInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                performSearch();
            }
        });
    }
});

let applicationToDelete = null;

// SHOW EDIT APPLICATION MODAL
function showEditApplicationModal(applicationId) {
    fetch(`/applications/${applicationId}/edit`)
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const app = data.application;

                document.getElementById('editApplicationId').value = app.id;
                document.getElementById('editApplicationOfferTitle').textContent = app.offerTitle;
                document.getElementById('editCoverLetter').value = app.coverLetter || '';

                // Clear previous errors
                document.querySelectorAll('.is-invalid').forEach(el => el.classList.remove('is-invalid'));

                // Show modal
                const modal = new bootstrap.Modal(document.getElementById('editApplicationModal'));
                modal.show();
            } else {
                showToast('error', data.error || 'Failed to load application');
            }
        })
        .catch(error => {
            console.error('Edit application error:', error);
            showToast('error', 'Failed to load application details');
        });
}

// UPDATE APPLICATION
function updateApplication() {
    const applicationId = document.getElementById('editApplicationId').value;
    const coverLetter = document.getElementById('editCoverLetter').value;
    const resumeFile = document.getElementById('editResumeFile').files[0];

    // Clear previous errors
    document.querySelectorAll('.is-invalid').forEach(el => el.classList.remove('is-invalid'));
    document.querySelectorAll('.invalid-feedback').forEach(el => el.textContent = '');

    // Validate form
    let isValid = true;

    if (!coverLetter.trim()) {
        document.getElementById('editCoverLetter').classList.add('is-invalid');
        document.getElementById('editCoverLetterError').textContent = 'Cover letter is required';
        isValid = false;
    }

    if (resumeFile && resumeFile.size > 5 * 1024 * 1024) { // 5MB limit
        document.getElementById('editResumeFile').classList.add('is-invalid');
        document.getElementById('editResumeFileError').textContent = 'File size must be less than 5MB';
        isValid = false;
    }

    if (!isValid) return;

    // Prepare form data
    const formData = new FormData();
    formData.append('coverLetter', coverLetter);
    if (resumeFile) {
        formData.append('resume', resumeFile);
    }

    // Update application
    fetch(`/applications/${applicationId}/update`, {
        method: 'PUT',
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            // Close modal
            const modal = bootstrap.Modal.getInstance(document.getElementById('editApplicationModal'));
            modal.hide();

            showToast('success', data.message);

            // Update cover letter preview in table
            const coverLetterCell = document.querySelector(`#application-${applicationId} td:nth-child(3)`);
            if (coverLetterCell) {
                const preview = coverLetter.length > 100 ? coverLetter.substring(0, 100) + '...' : coverLetter;
                coverLetterCell.querySelector('.cover-letter-preview').textContent = preview;
            }

        } else {
            showToast('error', data.error || 'Update failed');
        }
    })
    .catch(error => {
        console.error('Update error:', error);
        showToast('error', 'Network error occurred');
    });
}

// DELETE APPLICATION
function deleteApplication(applicationId) {
    applicationToDelete = applicationId;

    // Show confirmation modal
    const modal = new bootstrap.Modal(document.getElementById('deleteApplicationModal'));
    modal.show();
}

// CONFIRM DELETE APPLICATION
function confirmDeleteApplication() {
    if (!applicationToDelete) return;

    fetch(`/applications/${applicationToDelete}/delete`, {
        method: 'DELETE',
        headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
        }
    })
    .then(response => response.json())
    .then(data => {
        // Close modal
        const modal = bootstrap.Modal.getInstance(document.getElementById('deleteApplicationModal'));
        if (modal) modal.hide();

        if (data.success) {
            // Remove row from table
            const row = document.getElementById(`application-${applicationToDelete}`);
            if (row) row.remove();

            showToast('success', data.message);

            // Check if table is empty
            const tbody = document.getElementById('applicationsTableBody');
            if (tbody && tbody.children.length === 0) {
                // Add empty state message
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" class="text-center py-5">
                            <i class="bi bi-file-earmark-text" style="font-size: 3rem; color: #dee2e6;"></i>
                            <h5 class="text-muted mt-3">No applications found</h5>
                            <p class="text-muted">You haven't applied to any job offers yet</p>
                        </td>
                    </tr>
                `;
            }

            // Reload stats
            loadStats();

        } else {
            showToast('error', data.error || 'Delete failed');
        }

        // Reset variable
        applicationToDelete = null;
    })
    .catch(error => {
        console.error('Delete error:', error);
        showToast('error', 'Network error occurred');
        applicationToDelete = null;
    });
}
</script>
{% endblock %}


==========================================================================================
FILE: templates\candidate_dashboard\index.html.twig
==========================================================================================

{% extends 'base.html.twig' %}

{% block title %}Candidate Dashboard - HireFlow{% endblock %}

{% block stylesheets %}
{{ parent() }}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.css">
<style>
    .stat-card {
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        transition: transform 0.3s;
    }
    .stat-card:hover {
        transform: translateY(-5px);
    }
    .stat-card.total { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    .stat-card.pending { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
    .stat-card.accepted { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
    .stat-card.rejected { background: linear-gradient(135deg, #f6d365 0%, #fda085 100%); }

    .stat-number {
        font-size: 2.5rem;
        font-weight: bold;
        color: white;
        margin: 0;
    }
    .stat-label {
        color: rgba(255,255,255,0.9);
        font-size: 1rem;
        margin: 0;
    }

    .status-badge {
        padding: 5px 15px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 600;
    }
    .status-pending { background: #fff3cd; color: #856404; }
    .status-accepted { background: #d4edda; color: #155724; }
    .status-rejected { background: #f8d7da; color: #721c24; }

    .table th {
        border-top: none;
        font-weight: 600;
        color: #495057;
    }

    .btn-view {
        background: #6c757d;
        color: white;
        padding: 5px 15px;
        border-radius: 4px;
        text-decoration: none;
        font-size: 0.85rem;
    }
    .btn-view:hover {
        background: #5a6268;
        color: white;
        text-decoration: none;
    }

    .btn-apply {
        background: #007bff;
        color: white;
        padding: 10px 25px;
        border-radius: 5px;
        text-decoration: none;
        font-weight: 600;
    }
    .btn-apply:hover {
        background: #0056b3;
        color: white;
        text-decoration: none;
    }

    /* Chart container styles */
    .chart-container {
        position: relative;
        height: 250px;
        width: 100%;
        margin: 0 auto;
    }

    .chart-legend {
        list-style: none;
        padding: 0;
        margin: 20px 0 0 0;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 10px;
    }

    .chart-legend-item {
        display: flex;
        align-items: center;
        font-size: 0.8rem;
        color: #6c757d;
    }

    .legend-color {
        width: 12px;
        height: 12px;
        border-radius: 2px;
        margin-right: 6px;
        display: inline-block;
    }

    .no-data-chart {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 200px;
        color: #6c757d;
    }

    .no-data-chart i {
        font-size: 3rem;
        margin-bottom: 10px;
        opacity: 0.5;
    }
</style>
{% endblock %}

{% block body %}
<div class="container-fluid">
    <!-- Page Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h1 class="h3 mb-0">Welcome back, {{ app.user.fullName }} </h1>
            <p class="text-muted mb-0">Track your job applications and discover new opportunities</p>
        </div>
        <div class="d-flex gap-2">
            <a href="{{ path('offer_index') }}" class="btn btn-primary">
                <i class="bi bi-search me-2"></i>Browse Jobs
            </a>
            <!-- Note: We'll add this link when we create the profile page -->
            <!-- <a href="{{ path('profile_edit') }}" class="btn btn-outline-primary">
                <i class="bi bi-person me-2"></i>Edit Profile
            </a> -->
        </div>
    </div>

    <!-- Statistics Cards -->
    <div class="row mb-5">
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="stat-card total h-100">
                <div class="d-flex align-items-center">
                    <div class="flex-grow-1">
                        <p class="stat-label">Total Applications</p>
                        <h2 class="stat-number">{{ stats.total|default(0) }}</h2>
                    </div>
                    <div class="ms-3">
                        <i class="bi bi-file-text" style="font-size: 2.5rem; color: rgba(255,255,255,0.8);"></i>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-4">
            <div class="stat-card pending h-100">
                <div class="d-flex align-items-center">
                    <div class="flex-grow-1">
                        <p class="stat-label">Pending Review</p>
                        <h2 class="stat-number">{{ stats.pending|default(0) }}</h2>
                    </div>
                    <div class="ms-3">
                        <i class="bi bi-clock" style="font-size: 2.5rem; color: rgba(255,255,255,0.8);"></i>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-4">
            <div class="stat-card accepted h-100">
                <div class="d-flex align-items-center">
                    <div class="flex-grow-1">
                        <p class="stat-label">Accepted</p>
                        <h2 class="stat-number">{{ stats.accepted|default(0) }}</h2>
                    </div>
                    <div class="ms-3">
                        <i class="bi bi-check-circle" style="font-size: 2.5rem; color: rgba(255,255,255,0.8);"></i>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-4">
            <div class="stat-card rejected h-100">
                <div class="d-flex align-items-center">
                    <div class="flex-grow-1">
                        <p class="stat-label">Rejected</p>
                        <h2 class="stat-number">{{ stats.rejected|default(0) }}</h2>
                    </div>
                    <div class="ms-3">
                        <i class="bi bi-x-circle" style="font-size: 2.5rem; color: rgba(255,255,255,0.8);"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Two Columns Layout -->
    <div class="row">
        <!-- Recent Applications -->
        <div class="col-lg-8 mb-4">
            <div class="card shadow-sm h-100">
                <div class="card-header bg-white border-bottom">
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">Recent Applications</h5>
                        {% if applications|length > 0 %}
                        <span class="badge bg-primary">{{ applications|length }} total</span>
                        {% endif %}
                    </div>
                </div>
                <div class="card-body">
                    {% if applications|length > 0 %}
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Position</th>
                                        <th>Company</th>
                                        <th>Applied Date</th>
                                        <th>Status</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for application in applications|slice(0, 5) %}
                                    <tr>
                                        <td>
                                            <div class="fw-semibold">{{ application.offer.title }}</div>
                                            <small class="text-muted">{{ application.offer.skills|split(',')|slice(0, 2)|join(', ') }}</small>
                                        </td>
                                        <td>{{ application.offer.recruiter.fullName }}</td>
                                        <td>{{ application.createdAt|date('M d, Y') }}</td>
                                        <td>
                                            <span class="status-badge status-{{ application.status|lower }}">
                                                {{ application.status }}
                                            </span>
                                        </td>
                                        <td>
                                            <a href="#" class="btn-view">View Details</a>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>

                        {% if applications|length > 5 %}
                            <div class="text-center mt-3">
                                <a href="#" class="btn btn-outline-primary btn-sm">View All Applications</a>
                            </div>
                        {% endif %}
                    {% else %}
                        <div class="text-center py-5">
                            <div class="mb-4">
                                <i class="bi bi-file-text" style="font-size: 4rem; color: #dee2e6;"></i>
                            </div>
                            <h5 class="text-muted mb-3">No applications yet</h5>
                            <p class="text-muted mb-4">Start your job search and apply to positions that match your skills</p>
                            <a href="{{ path('offer_index') }}" class="btn btn-primary btn-lg">
                                <i class="bi bi-search me-2"></i>Browse Available Jobs
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Application Status Chart -->
        <div class="col-lg-4 mb-4">
            <!-- Application Status Chart -->
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-white border-bottom">
                    <h5 class="mb-0">Application Status Distribution</h5>
                </div>
                <div class="card-body">
                    {% if stats.total > 0 %}
                        <div class="chart-container">
                            <canvas id="applicationStatusChart"></canvas>
                        </div>
                        <ul class="chart-legend" id="chartLegend">
                            <!-- Legend will be populated by JavaScript -->
                        </ul>
                    {% else %}
                        <div class="no-data-chart">
                            <i class="bi bi-pie-chart"></i>
                            <p class="text-muted">No application data available</p>
                            <small>Apply to jobs to see status distribution</small>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- Quick Tips -->
            <div class="card shadow-sm">
                <div class="card-header bg-white border-bottom">
                    <h5 class="mb-0">Job Search Tips</h5>
                </div>
                <div class="card-body">
                    <div class="d-flex mb-3">
                        <div class="flex-shrink-0">
                            <i class="bi bi-check-circle-fill text-success"></i>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <small class="text-muted">Customize your resume for each application to highlight relevant skills.</small>
                        </div>
                    </div>
                    <div class="d-flex mb-3">
                        <div class="flex-shrink-0">
                            <i class="bi bi-check-circle-fill text-success"></i>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <small class="text-muted">Follow up after 5-7 business days if you haven't heard back.</small>
                        </div>
                    </div>
                    <div class="d-flex">
                        <div class="flex-shrink-0">
                            <i class="bi bi-check-circle-fill text-success"></i>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <small class="text-muted">Prepare for interviews by researching the company and practicing common questions.</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block javascripts_body %}
<!-- Chart.js Library -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('Candidate dashboard loaded');

    // Only initialize chart if we have data
    const stats = {
        total: {{ stats.total|default(0) }},
        pending: {{ stats.pending|default(0) }},
        accepted: {{ stats.accepted|default(0) }},
        rejected: {{ stats.rejected|default(0) }}
    };

    if (stats.total > 0) {
        initializeApplicationChart(stats);
    }

    // Function to initialize the application status chart
    function initializeApplicationChart(stats) {
        const ctx = document.getElementById('applicationStatusChart').getContext('2d');
        const legendContainer = document.getElementById('chartLegend');

        // Define colors for each status
        const colorPalette = {
            pending: 'rgba(255, 193, 7, 0.8)',
            accepted: 'rgba(40, 167, 69, 0.8)',
            rejected: 'rgba(220, 53, 69, 0.8)'
        };

        // Border colors (slightly darker)
        const borderColors = {
            pending: 'rgb(255, 193, 7)',
            accepted: 'rgb(40, 167, 69)',
            rejected: 'rgb(220, 53, 69)'
        };

        // Prepare data
        const labels = [];
        const data = [];
        const backgroundColors = [];
        const borderColorArray = [];

        // Add data only if count > 0
        if (stats.pending > 0) {
            labels.push('Pending');
            data.push(stats.pending);
            backgroundColors.push(colorPalette.pending);
            borderColorArray.push(borderColors.pending);
        }

        if (stats.accepted > 0) {
            labels.push('Accepted');
            data.push(stats.accepted);
            backgroundColors.push(colorPalette.accepted);
            borderColorArray.push(borderColors.accepted);
        }

        if (stats.rejected > 0) {
            labels.push('Rejected');
            data.push(stats.rejected);
            backgroundColors.push(colorPalette.rejected);
            borderColorArray.push(borderColors.rejected);
        }

        // Create chart
        const chart = new Chart(ctx, {
            type: 'pie',
            data: {
                labels: labels,
                datasets: [{
                    data: data,
                    backgroundColor: backgroundColors,
                    borderColor: borderColorArray,
                    borderWidth: 1,
                    hoverOffset: 15
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false // We'll create custom legend
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const label = context.label || '';
                                const value = context.raw || 0;
                                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                const percentage = Math.round((value / total) * 100);
                                return `${label}: ${value} (${percentage}%)`;
                            }
                        }
                    }
                },
                animation: {
                    animateScale: true,
                    animateRotate: true,
                    duration: 1000
                }
            }
        });

        // Create custom legend
        if (legendContainer) {
            legendContainer.innerHTML = '';

            labels.forEach((label, index) => {
                const li = document.createElement('li');
                li.className = 'chart-legend-item';

                const colorSpan = document.createElement('span');
                colorSpan.className = 'legend-color';
                colorSpan.style.backgroundColor = backgroundColors[index];

                const textSpan = document.createElement('span');
                const percentage = Math.round((data[index] / stats.total) * 100);
                textSpan.textContent = `${label}: ${data[index]} (${percentage}%)`;

                li.appendChild(colorSpan);
                li.appendChild(textSpan);
                legendContainer.appendChild(li);
            });
        }

        // Add resize event listener to handle chart resizing
        window.addEventListener('resize', function() {
            chart.resize();
        });

        return chart;
    }

    // Optional: Add animation to stat cards on scroll
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, observerOptions);

    // Animate stat cards
    document.querySelectorAll('.stat-card').forEach(card => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
        observer.observe(card);
    });

    // Add click event for view details buttons (placeholder for now)
    document.querySelectorAll('.btn-view').forEach(button => {
        button.addEventListener('click', function(e) {
            e.preventDefault();
            // This will be implemented when we add application detail modals
            console.log('View details clicked - to be implemented');
        });
    });
});
</script>
{% endblock %}


==========================================================================================
FILE: templates\components\_sidebar_candidate.html.twig
==========================================================================================

{# templates/components/_sidebar_candidate.html.twig #}
<nav class="sidebar bg-light border-end" style="height: 100vh; position: sticky; top: 0;">
    <div class="sidebar-header p-3 border-bottom">
        <h4 class="mb-0">Candidate</h4>
        <small class="text-muted">{{ app.user.email }}</small>
    </div>

    <ul class="nav flex-column p-3">
        <li class="nav-item mb-2">
            <a href="{{ path('candidate_dashboard') }}"
               class="nav-link rounded {% if app.request.attributes.get('_route') == 'candidate_dashboard' %}active bg-primary text-white{% else %}text-dark{% endif %}">
                <img src="{{ asset('images/pie-chart.png') }}" alt="Applications" class="me-2" style="width: 20px; height: 20px;"> Dashboard
            </a>
        </li>
        <li class="nav-item mb-2">
            <a href="{{ path('offer_index') }}"
               class="nav-link rounded {% if 'offer_' in app.request.attributes.get('_route') %}active bg-primary text-white{% else %}text-dark{% endif %}">
                <img src="{{ asset('images/job-promotion.png') }}" alt="Applications" class="me-2" style="width: 20px; height: 20px;"> Browse Jobs
            </a>
        </li>
        <li class="nav-item mb-2">
            <a href="{{ path('application_index') }}"
               class="nav-link rounded  {% if app.request.attributes.get('_route') starts with 'application_' %}active bg-primary text-white{% else %}text-dark{% endif %}">
                <img src="{{ asset('images/curriculum-vitae.png') }}" alt="Applications" class="me-2" style="width: 20px; height: 20px;"> My Applications
            </a>
        </li>
        <li class="nav-item mb-2">
            <a href="{{ path('profile_edit') }}"
               class="nav-link rounded {% if app.request.attributes.get('_route') == 'profile_edit' %}active bg-primary text-white{% else %}text-dark{% endif %}">
                <img src="{{ asset('images/utilisateur.png') }}" alt="Applications" class="me-2" style="width: 20px; height: 20px;"> My Profile
            </a>
        </li>
        <li class="nav-item mt-4 pt-3 border-top">
            <a href="{{ path('app_logout') }}" class="nav-link text-danger">
                <img src="{{ asset('images/door.png') }}" alt="Applications" class="me-2" style="width: 20px; height: 20px;"> Logout
            </a>
        </li>
    </ul>
</nav>


==========================================================================================
FILE: templates\components\_sidebar_recruiter.html.twig
==========================================================================================

{# templates/components/_sidebar_recruiter.html.twig #}
<nav class="sidebar bg-light border-end" style="height: 100vh; position: sticky; top: 0;">
    <div class="sidebar-header p-3 border-bottom">
        <h4 class="mb-0">Recruiter</h4>
        <small class="text-muted">{{ app.user.email }}</small>
    </div>

    <ul class="nav flex-column p-3">
        <li class="nav-item mb-2">
            <a href="{{ path("recruiter_dashboard")}}"
               class="nav-link rounded {% if app.request.attributes.get('_route') == 'recruiter_dashboard' %}active bg-primary text-white{% else %}text-dark{% endif %}">
                <img src="{{ asset('images/pie-chart.png') }}" alt="Applications" class="me-2" style="width: 20px; height: 20px;"> Dashboard
            </a>
        </li>
        <li class="nav-item mb-2">
            <a href="{{ path('offer_index') }}"
               class="nav-link rounded {% if 'offer_' in app.request.attributes.get('_route') %}active bg-primary text-white{% else %}text-dark{% endif %}">
                <img src="{{ asset('images/job-promotion.png') }}" alt="Applications" class="me-2" style="width: 20px; height: 20px;"> My Job Offers
            </a>
        </li>
        <li class="nav-item mb-2">
            <a href="{{ path('application_index') }}"
               class="nav-link rounded  {% if app.request.attributes.get('_route') starts with 'application_' %} active bg-primary text-white {% else %}text-dark{% endif%}">
                                <img src="{{ asset('images/curriculum-vitae.png') }}" alt="Applications" class="me-2" style="width: 20px; height: 20px;"> Applications
            </a>
        </li>
        <li class="nav-item mb-2">
            <a href="{{ path('profile_edit') }}"
               class="nav-link rounded {% if app.request.attributes.get('_route') == 'profile_edit' %}active bg-primary text-white{% else %}text-dark{% endif %}">
                <img src="{{ asset('images/utilisateur.png') }}" alt="Applications" class="me-2" style="width: 20px; height: 20px;"> My Profile
            </a>
            </a>
        </li>
        <li class="nav-item mt-4 pt-3 border-top">
            <a href="{{ path('app_logout') }}" class="nav-link text-danger">
                <img src="{{ asset('images/door.png') }}" alt="Applications" class="me-2" style="width: 20px; height: 20px;"> Logout
            </a>
        </li>
    </ul>
</nav>


==========================================================================================
FILE: templates\home\index.html.twig
==========================================================================================

{% extends 'base.html.twig' %}

{% block title %}Hello HomeController!{% endblock %}

{% block body %}
<style>
    .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
</style>

<div class="example-wrapper">
    <h1>Hello {{ controller_name }}! ✅</h1>

    This friendly message is coming from:
    <ul>
        <li>Your controller at <code>C:/Users/khalfi aymane/Desktop/HireFlow/src/Controller/HomeController.php</code></li>
        <li>Your template at <code>C:/Users/khalfi aymane/Desktop/HireFlow/templates/home/index.html.twig</code></li>
    </ul>
</div>
{% endblock %}


==========================================================================================
FILE: templates\offer\index.html.twig
==========================================================================================

{% extends 'base.html.twig' %}

{% block title %}Job Offers - HireFlow{% endblock %}

{% block stylesheets %}
{{ parent() }}
<style>
    .table-container {
        background: white;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        overflow: hidden;
    }
    .table th {
        background-color: #f8f9fa;
        border-bottom: 2px solid #dee2e6;
        font-weight: 600;
        color: #495057;
    }
    .skill-badge {
        background: #e8f4fc;
        color: #3498db;
        padding: 4px 10px;
        border-radius: 12px;
        font-size: 0.85rem;
        margin: 2px;
        display: inline-block;
    }
    .action-btn {
        padding: 5px 12px;
        font-size: 0.85rem;
        border-radius: 4px;
        margin: 2px;
    }
    .modal-lg-custom {
        max-width: 800px;
    }
    .offer-description {
        white-space: pre-wrap;
        line-height: 1.6;
    }
</style>
{% endblock %}

{% block body %}
<div class="container-fluid">
    <!-- Page Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h1 class="h3 mb-0">Job Offers</h1>
            <p class="text-muted mb-0">
                {% if is_granted('ROLE_RECRUITER') %}
                    Manage your job offers - All actions in one place
                {% else %}
                    Browse available positions
                {% endif %}
            </p>
        </div>

        <!-- Create New Button (only for recruiters) -->
        {% if is_granted('ROLE_RECRUITER') %}
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#createOfferModal">
                <i class="bi bi-plus-circle me-2"></i>Create New Offer
            </button>
        {% endif %}
    </div>

    {# search #}
    <div class="row mb-4">
        <div class="col-md-8">
            <div class="input-group">
                <input type="text" class="form-control" id="searchInput" placeholder="Search by title or description...">
                <input type="text" class="form-control" id="skillsFilter" placeholder="Filter by skills (comma separated)...">
                <button class="btn btn-outline-primary" onclick="performSearch()">
                    <i class="bi bi-search"></i> Search
                </button>
                <button class="btn btn-outline-secondary" onclick="clearSearch()">
                    <i class="bi bi-x-circle"></i> Clear
                </button>
            </div>
        </div>
    </div>

    <!-- Offers Table -->
    <div class="table-container">
        <div class="table-responsive">
            <table class="table table-hover mb-0">
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Description</th>
                        <th>Skills</th>
                        <th>Location</th>
                        <th>Salary</th>
                        <th>Type</th>
                        <th>Applications</th>
                        <th>Created</th>
                        <th class="text-center">Actions</th>
                    </tr>
                </thead>
                <tbody id="offersTableBody">
                    {% for offer in offers %}
                    <tr id="offer-{{ offer.id }}">
                        <td class="fw-semibold">{{ offer.title }}</td>
                        <td>{{ offer.description|slice(0, 80) }}...</td>
                        <td>
                            {% for skill in offer.skills|split(',')|slice(0, 2) %}
                                {% if skill|trim %}
                                    <span class="skill-badge">{{ skill|trim }}</span>
                                {% endif %}
                            {% endfor %}
                            {% if offer.skills|split(',')|length > 2 %}
                                <span class="skill-badge">+{{ offer.skills|split(',')|length - 2 }}</span>
                            {% endif %}
                        </td>
                        <td>{{ offer.location|default('Remote') }}</td>
                        <td>{{ offer.salary|default('Not specified') }}</td>
                        <td>
                            <span class="badge bg-secondary">{{ offer.contractType|default('Full-time') }}</span>
                        </td>
                        <td class="text-center">
                            <span class="badge bg-primary">{{ offer.applications|length }}</span>
                        </td>
                        <td>{{ offer.createdAt|date('M d, Y') }}</td>
                        <td class="text-center">
                            <div class="btn-group btn-group-sm" role="group">
                                <!-- View Details Button -->
                                <button type="button" class="btn btn-outline-info action-btn"
                                        onclick="showOfferDetails({{ offer.id }})"
                                        title="View Details">
                                    <i class="bi bi-eye"></i>
                                </button>

                                <!-- Edit Button (only for recruiter who owns the offer) -->
                                {% if is_granted('ROLE_RECRUITER') and offer.recruiter.id == app.user.id %}
                                    <button type="button" class="btn btn-outline-primary action-btn"
                                            onclick="openEditOfferModal({{ offer.id }})"
                                            title="Edit Offer">
                                        <i class="bi bi-pencil"></i>
                                    </button>

                                    <!-- Delete Button -->
                                    <button type="button" class="btn btn-outline-danger action-btn"
                                            onclick="deleteOffer({{ offer.id }})"
                                            title="Delete Offer">
                                        <i class="bi bi-trash"></i>
                                    </button>
                                {% endif %}

                                <!-- Apply Button (for candidates) -->
                                {% if is_granted('ROLE_CANDIDATE') %}
                                    <button type="button" class="btn btn-success action-btn"
                                            onclick="showApplyModal({{ offer.id }}, '{{ offer.title|e('js') }}')"
                                            title="Apply Now">
                                        <i class="bi bi-send"></i>
                                    </button>
                                {% endif %}
                            </div>
                        </td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="9" class="text-center py-5">
                            <i class="bi bi-briefcase" style="font-size: 3rem; color: #dee2e6;"></i>
                            <h5 class="text-muted mt-3">No job offers found</h5>
                            {% if is_granted('ROLE_RECRUITER') %}
                                <p class="text-muted">Click "Create New Offer" to add your first job offer</p>
                            {% else %}
                                <p class="text-muted">Check back soon for new opportunities</p>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- CREATE OFFER MODAL -->
<div class="modal fade" id="createOfferModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-lg-custom">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Create New Job Offer</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                {{ form_start(form, {'attr': {'id': 'offerForm'}}) }}

                <div class="row mb-3">
                    <div class="col-12">
                        {{ form_label(form.title) }}
                        {{ form_widget(form.title) }}
                        <div class="invalid-feedback" id="titleError"></div>
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col-12">
                        {{ form_label(form.description) }}
                        {{ form_widget(form.description) }}
                        <div class="invalid-feedback" id="descriptionError"></div>
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col-12">
                        {{ form_label(form.skills) }}
                        {{ form_widget(form.skills) }}
                        <small class="form-text text-muted">Separate skills with commas</small>
                        <div class="invalid-feedback" id="skillsError"></div>
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col-md-6">
                        {{ form_label(form.location) }}
                        {{ form_widget(form.location) }}
                    </div>
                    <div class="col-md-6">
                        {{ form_label(form.salary) }}
                        {{ form_widget(form.salary) }}
                    </div>
                </div>

                <div class="row mb-4">
                    <div class="col-md-6">
                        {{ form_label(form.contractType) }}
                        {{ form_widget(form.contractType) }}
                    </div>
                </div>

                {{ form_end(form) }}
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="createOffer()">
                    <i class="bi bi-check-circle me-2"></i>Create Offer
                </button>
            </div>
        </div>
    </div>
</div>

<!-- EDIT OFFER MODAL -->
<div class="modal fade" id="editOfferModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-lg-custom">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Edit Job Offer</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="editOfferForm">
                    <input type="hidden" id="editOfferId">

                    <div class="row mb-3">
                        <div class="col-12">
                            <label for="editTitle" class="form-label">Job Title</label>
                            <input type="text" class="form-control" id="editTitle" required>
                            <div class="invalid-feedback" id="editTitleError"></div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-12">
                            <label for="editDescription" class="form-label">Description</label>
                            <textarea class="form-control" id="editDescription" rows="5" required></textarea>
                            <div class="invalid-feedback" id="editDescriptionError"></div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-12">
                            <label for="editSkills" class="form-label">Required Skills</label>
                            <textarea class="form-control" id="editSkills" rows="3" required></textarea>
                            <small class="form-text text-muted">Separate skills with commas</small>
                            <div class="invalid-feedback" id="editSkillsError"></div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="editLocation" class="form-label">Location</label>
                            <input type="text" class="form-control" id="editLocation">
                        </div>
                        <div class="col-md-6">
                            <label for="editSalary" class="form-label">Salary</label>
                            <input type="text" class="form-control" id="editSalary">
                        </div>
                    </div>

                    <div class="row mb-4">
                        <div class="col-md-6">
                            <label for="editContractType" class="form-label">Contract Type</label>
                            <select class="form-select" id="editContractType">
                                <option value="">Select type</option>
                                <option value="Full-time">Full-time</option>
                                <option value="Part-time">Part-time</option>
                                <option value="Contract">Contract</option>
                                <option value="Remote">Remote</option>
                                <option value="Internship">Internship</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="updateOffer()">
                    <i class="bi bi-check-circle me-2"></i>Update Offer
                </button>
            </div>
        </div>
    </div>
</div>

<!-- VIEW OFFER MODAL -->
<div class="modal fade" id="viewOfferModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-lg-custom">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="viewOfferTitle"></h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="d-flex flex-wrap gap-2 mb-3">
                            <span class="badge bg-primary" id="viewContractType"></span>
                            <span class="badge bg-secondary" id="viewLocation"></span>
                            <span class="badge bg-success" id="viewSalary"></span>
                            <span class="badge bg-info">
                                <i class="bi bi-calendar me-1"></i><span id="viewCreatedAt"></span>
                            </span>
                            <span class="badge bg-warning">
                                <i class="bi bi-person me-1"></i><span id="viewRecruiter"></span>
                            </span>
                        </div>
                    </div>
                </div>

                <div class="row mb-4">
                    <div class="col-12">
                        <h6 class="mb-2">Description</h6>
                        <div class="bg-light p-3 rounded offer-description" id="viewDescription"></div>
                    </div>
                </div>

                <div class="row mb-4">
                    <div class="col-12">
                        <h6 class="mb-2">Required Skills</h6>
                        <div id="viewSkills"></div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-12">
                        <div class="alert alert-info">
                            <div class="d-flex align-items-center">
                                <i class="bi bi-info-circle me-3" style="font-size: 1.5rem;"></i>
                                <div>
                                    <strong>Applications:</strong> <span id="viewApplicationsCount">0</span> candidates have applied
                                    {% if is_granted('ROLE_RECRUITER') %}
                                        <br><small>Click "View Applications" in the table to manage applications</small>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="paginationContainer" class="mt-4"></div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                {% if is_granted('ROLE_CANDIDATE') %}
                    <button type="button" class="btn btn-primary" onclick="applyToOffer()" disabled>
                        <i class="bi bi-send me-2"></i>Apply Now
                    </button>
                {% endif %}
            </div>
        </div>
    </div>
</div>
<!-- APPLY TO OFFER MODAL -->
<div class="modal fade" id="applyOfferModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-lg-custom">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Apply to <span id="applyOfferTitle"></span></h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="applyForm">
                    <input type="hidden" id="applyOfferId">

                    <div class="row mb-3">
                        <div class="col-12">
                            <label for="coverLetter" class="form-label">Cover Letter *</label>
                            <textarea class="form-control" id="coverLetter" rows="5" required
                                      placeholder="Introduce yourself and explain why you're a good fit for this position..."></textarea>
                            <div class="invalid-feedback" id="coverLetterError"></div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-12">
                            <label for="resumeFile" class="form-label">Resume / CV *</label>
                            <input type="file" class="form-control" id="resumeFile" accept=".pdf,.doc,.docx,.txt" required>
                            <small class="form-text text-muted">
                                Accepted formats: PDF, DOC, DOCX, TXT (Max 5MB)
                            </small>
                            <div class="invalid-feedback" id="resumeFileError"></div>
                        </div>
                    </div>

                    <div class="row mb-4">
                        <div class="col-12">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="confirmInfo" required>
                                <label class="form-check-label" for="confirmInfo">
                                    I confirm that the information provided is accurate and complete
                                </label>
                                <div class="invalid-feedback" id="confirmInfoError"></div>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-info">
                        <i class="bi bi-info-circle me-2"></i>
                        Your application will be submitted to the recruiter. You can track its status in "My Applications".
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-success" onclick="submitApplication()">
                    <i class="bi bi-send me-2"></i>Submit Application
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block javascripts_body %}
<script>
// Global variables
let currentOfferId = null;

// CREATE OFFER
function createOffer() {
    const form = document.getElementById('offerForm');
    if (!form) {
        showToast('error', 'Form not found!');
        return;
    }

    const formData = new FormData(form);

    fetch('/offers/new', {
        method: 'POST',
        body: formData
    })
    .then(response => {
        if (!response.ok) {
            return response.json().then(data => {
                // Handle validation errors
                if (data.errors && Array.isArray(data.errors)) {
                    showFormErrors(data.errors);
                    return { success: false };
                }
                throw new Error(data.error || 'Request failed');
            });
        }
        return response.json();
    })
    .then(data => {
        if (data.success) {
            const modal = bootstrap.Modal.getInstance(document.getElementById('createOfferModal'));
            if (modal) modal.hide();
            showToast('success', data.message);
            setTimeout(() => location.reload(), 1000);
        }
    })
    .catch(error => {
        console.error('Error:', error);
        showToast('error', error.message || 'An error occurred');
    });
}

// OPEN EDIT MODAL
function openEditOfferModal(offerId) {
    currentOfferId = offerId;

    fetch(`/offers/${offerId}/edit`)
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Fill form with offer data
                document.getElementById('editOfferId').value = data.offer.id;
                document.getElementById('editTitle').value = data.offer.title;
                document.getElementById('editDescription').value = data.offer.description;
                document.getElementById('editSkills').value = data.offer.skills;
                document.getElementById('editLocation').value = data.offer.location || '';
                document.getElementById('editSalary').value = data.offer.salary || '';
                document.getElementById('editContractType').value = data.offer.contractType || '';

                // Show modal
                const modal = new bootstrap.Modal(document.getElementById('editOfferModal'));
                modal.show();
            } else {
                showToast('error', data.error || 'Failed to load offer');
            }
        });
}

// UPDATE OFFER
function updateOffer() {
    const offerId = document.getElementById('editOfferId').value;
    const data = {
        title: document.getElementById('editTitle').value,
        description: document.getElementById('editDescription').value,
        skills: document.getElementById('editSkills').value,
        location: document.getElementById('editLocation').value,
        salary: document.getElementById('editSalary').value,
        contractType: document.getElementById('editContractType').value
    };

    fetch(`/offers/${offerId}/update`, {
        method: 'PUT',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            // Close modal
            const modal = bootstrap.Modal.getInstance(document.getElementById('editOfferModal'));
            modal.hide();

            // Show success
            showToast('success', data.message);

            // Update table row (simplified - reload for now)
            setTimeout(() => location.reload(), 1000);
        } else {
            showToast('error', data.error || 'Update failed');
        }
    });
}

// DELETE OFFER
function deleteOffer(offerId) {
    if (!confirm('Are you sure you want to delete this offer?')) return;

    // First try to delete just the offer
    fetch(`/offers/${offerId}/delete?deleteMode=offer_only`, {
        method: 'DELETE',
        headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            // Success - remove row from table
            const row = document.getElementById(`offer-${offerId}`);
            if (row) row.remove();

            showToast('success', data.message);

            // Check if table is empty
            const tbody = document.getElementById('offersTableBody');
            if (tbody && tbody.children.length === 0) {
                // Add empty state message
                tbody.innerHTML = `
                    <tr>
                        <td colspan="9" class="text-center py-5">
                            <i class="bi bi-briefcase" style="font-size: 3rem; color: #dee2e6;"></i>
                            <h5 class="text-muted mt-3">No job offers found</h5>
                            {% if is_granted('ROLE_RECRUITER') %}
                                <p class="text-muted">Click "Create New Offer" to add your first job offer</p>
                            {% else %}
                                <p class="text-muted">Check back soon for new opportunities</p>
                            {% endif %}
                        </td>
                    </tr>
                `;
            }
        } else {
            // Check if it's because of applications
            if (data.hasApplications) {
                showDeleteConfirmationModal(offerId, data.applicationsCount);
            } else {
                showToast('error', data.error || 'Delete failed');
            }
        }
    })
    .catch(error => {
        console.error('Delete error:', error);
        showToast('error', 'Network error occurred');
    });
}

// SEARCH FUNCTIONS
function performSearch() {
    const searchTerm = document.getElementById('searchInput').value;
    const skillsFilter = document.getElementById('skillsFilter').value;

    fetch(`/offers/search?q=${encodeURIComponent(searchTerm)}&skills=${encodeURIComponent(skillsFilter)}`)
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                updateTableWithSearchResults(data.offers);
                updatePagination(data.pagination.totalPages, data.pagination.page);
            } else {
                showToast('error', 'Search failed');
            }
        })
        .catch(error => {
            console.error('Search error:', error);
            showToast('error', 'Search error occurred');
        });
}

function clearSearch() {
    document.getElementById('searchInput').value = '';
    document.getElementById('skillsFilter').value = '';

    // Reload the page to show all offers
    fetch(`/offers/search?q=&skills=`)
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                updateTableWithSearchResults(data.offers);
                updatePagination(data.pagination.totalPages, data.pagination.page);
            }
        })
        .catch(error => {
            console.error('Clear search error:', error);
            location.reload(); // Fallback to full reload
        });
}

function updateTableWithSearchResults(offers) {
    const tbody = document.getElementById('offersTableBody');

    if (!offers || offers.length === 0) {
        tbody.innerHTML = `
            <tr>
                <td colspan="9" class="text-center py-5">
                    <i class="bi bi-search" style="font-size: 3rem; color: #dee2e6;"></i>
                    <h5 class="text-muted mt-3">No matching offers found</h5>
                    <p class="text-muted">Try different search terms or filters</p>
                </td>
            </tr>
        `;
        return;
    }

    let html = '';
    offers.forEach(offer => {
        // Process skills for badges
        const skillsArray = offer.skills ? offer.skills.split(',').map(s => s.trim()) : [];
        const skillsDisplay = skillsArray.slice(0, 2);
        const extraSkillsCount = Math.max(0, skillsArray.length - 2);

        let skillsHtml = '';
        skillsDisplay.forEach(skill => {
            if (skill) {
                skillsHtml += `<span class="skill-badge">${skill}</span>`;
            }
        });
        if (extraSkillsCount > 0) {
            skillsHtml += `<span class="skill-badge">+${extraSkillsCount}</span>`;
        }

        html += `
        <tr id="offer-${offer.id}">
            <td class="fw-semibold">${offer.title}</td>
            <td>${offer.description ? (offer.description.length > 80 ? offer.description.substring(0, 80) + '...' : offer.description) : ''}</td>
            <td>${skillsHtml || 'Not specified'}</td>
            <td>${offer.location || 'Remote'}</td>
            <td>${offer.salary || 'Not specified'}</td>
            <td><span class="badge bg-secondary">${offer.contractType || 'Full-time'}</span></td>
            <td class="text-center"><span class="badge bg-primary">${offer.applicationsCount || 0}</span></td>
            <td>${offer.createdAt || ''}</td>
            <td class="text-center">
                <div class="btn-group btn-group-sm" role="group">
                    <button type="button" class="btn btn-outline-info action-btn"
                            onclick="showOfferDetails(${offer.id})"
                            title="View Details">
                        <i class="bi bi-eye"></i>
                    </button>
                    {% if is_granted('ROLE_RECRUITER') %}
                        <button type="button" class="btn btn-outline-primary action-btn"
                                onclick="openEditOfferModal(${offer.id})"
                                title="Edit Offer">
                            <i class="bi bi-pencil"></i>
                        </button>
                        <button type="button" class="btn btn-outline-danger action-btn"
                                onclick="deleteOffer(${offer.id})"
                                title="Delete Offer">
                            <i class="bi bi-trash"></i>
                        </button>
                    {% endif %}
                    {% if is_granted('ROLE_CANDIDATE') %}
                        <button type="button" class="btn btn-success action-btn"
                                onclick="applyToOffer(${offer.id})"
                                title="Apply Now" disabled>
                            <i class="bi bi-send"></i>
                        </button>
                    {% endif %}
                </div>
            </td>
        </tr>
        `;
    });

    tbody.innerHTML = html;
}

function updatePagination(totalPages, currentPage) {
    const paginationContainer = document.getElementById('paginationContainer');
    if (!paginationContainer || totalPages <= 1) {
        if (paginationContainer) {
            paginationContainer.innerHTML = '';
        }
        return;
    }

    let html = '<nav><ul class="pagination justify-content-center">';

    // Previous button
    if (currentPage > 1) {
        html += `<li class="page-item">
                    <a class="page-link" href="#" onclick="loadPage(${currentPage - 1})">Previous</a>
                 </li>`;
    } else {
        html += `<li class="page-item disabled">
                    <span class="page-link">Previous</span>
                 </li>`;
    }

    // Page numbers
    const maxVisiblePages = 5;
    let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
    let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);

    if (endPage - startPage + 1 < maxVisiblePages) {
        startPage = Math.max(1, endPage - maxVisiblePages + 1);
    }

    for (let i = startPage; i <= endPage; i++) {
        if (i === currentPage) {
            html += `<li class="page-item active">
                        <span class="page-link">${i}</span>
                     </li>`;
        } else {
            html += `<li class="page-item">
                        <a class="page-link" href="#" onclick="loadPage(${i})">${i}</a>
                     </li>`;
        }
    }

    // Next button
    if (currentPage < totalPages) {
        html += `<li class="page-item">
                    <a class="page-link" href="#" onclick="loadPage(${currentPage + 1})">Next</a>
                 </li>`;
    } else {
        html += `<li class="page-item disabled">
                    <span class="page-link">Next</span>
                 </li>`;
    }

    html += '</ul></nav>';
    paginationContainer.innerHTML = html;
}

function loadPage(page) {
    const searchTerm = document.getElementById('searchInput')?.value || '';
    const skillsFilter = document.getElementById('skillsFilter')?.value || '';

    fetch(`/offers/search?q=${encodeURIComponent(searchTerm)}&skills=${encodeURIComponent(skillsFilter)}&page=${page}`)
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                updateTableWithSearchResults(data.offers);
                updatePagination(data.pagination.totalPages, page);
                // Scroll to top of table
                document.querySelector('.table-container').scrollIntoView({ behavior: 'smooth' });
            }
        })
        .catch(error => {
            console.error('Page load error:', error);
            showToast('error', 'Error loading page');
        });
}

// DELETE CONFIRMATION MODAL
function showDeleteConfirmationModal(offerId, applicationsCount) {
    // Remove existing modal if any
    const existingModal = document.getElementById('deleteConfirmationModal');
    if (existingModal) existingModal.remove();

    // Create modal HTML
    const modalHTML = `
    <div class="modal fade" id="deleteConfirmationModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title">
                        <i class="bi bi-exclamation-triangle me-2"></i>Delete Offer with Applications
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-warning">
                        <i class="bi bi-exclamation-octagon me-2"></i>
                        <strong>Warning:</strong> This offer has <strong>${applicationsCount}</strong> application(s).
                    </div>
                    <p>If you delete this offer, all related applications will also be permanently deleted, including:</p>
                    <ul>
                        <li>Candidate CV/resume files</li>
                        <li>Cover letters</li>
                        <li>Application history</li>
                    </ul>
                    <p class="mb-0"><strong>Are you sure you want to continue?</strong></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle me-2"></i>Cancel
                    </button>
                    <button type="button" class="btn btn-danger" onclick="deleteOfferWithApplications(${offerId})">
                        <i class="bi bi-trash me-2"></i>Delete Offer & Applications
                    </button>
                </div>
            </div>
        </div>
    </div>
    `;

    // Add to document
    document.body.insertAdjacentHTML('beforeend', modalHTML);

    // Show modal
    const modal = new bootstrap.Modal(document.getElementById('deleteConfirmationModal'));
    modal.show();

    // Remove modal from DOM when hidden
    modal._element.addEventListener('hidden.bs.modal', () => {
        modal._element.remove();
    });
}

// In your offers.js file, add these functions:

// SHOW APPLY MODAL
function showApplyModal(offerId, offerTitle) {
    document.getElementById('applyOfferId').value = offerId;
    document.getElementById('applyOfferTitle').textContent = offerTitle;

    // Reset form
    document.getElementById('applyForm').reset();
    document.querySelectorAll('.is-invalid').forEach(el => el.classList.remove('is-invalid'));

    // Show modal
    const modal = new bootstrap.Modal(document.getElementById('applyOfferModal'));
    modal.show();
}

// SUBMIT APPLICATION
function submitApplication() {
    const offerId = document.getElementById('applyOfferId').value;
    const coverLetter = document.getElementById('coverLetter').value;
    const resumeFile = document.getElementById('resumeFile').files[0];
    const confirmInfo = document.getElementById('confirmInfo').checked;

    // Clear previous errors
    document.querySelectorAll('.is-invalid').forEach(el => el.classList.remove('is-invalid'));
    document.querySelectorAll('.invalid-feedback').forEach(el => el.textContent = '');

    // Validate form
    let isValid = true;

    if (!coverLetter.trim()) {
        document.getElementById('coverLetter').classList.add('is-invalid');
        document.getElementById('coverLetterError').textContent = 'Cover letter is required';
        isValid = false;
    }

    if (!resumeFile) {
        document.getElementById('resumeFile').classList.add('is-invalid');
        document.getElementById('resumeFileError').textContent = 'Resume file is required';
        isValid = false;
    } else if (resumeFile.size > 5 * 1024 * 1024) { // 5MB limit
        document.getElementById('resumeFile').classList.add('is-invalid');
        document.getElementById('resumeFileError').textContent = 'File size must be less than 5MB';
        isValid = false;
    }

    if (!confirmInfo) {
        document.getElementById('confirmInfo').classList.add('is-invalid');
        document.getElementById('confirmInfoError').textContent = 'Please confirm the information';
        isValid = false;
    }

    if (!isValid) return;

    // Prepare form data
    const formData = new FormData();
    formData.append('offerId', offerId);
    formData.append('coverLetter', coverLetter);
    formData.append('resume', resumeFile);

    // Submit application
    fetch('/applications/new', {
        method: 'POST',
        body: formData
    })
    .then(response => {
        // First, check if response is HTML instead of JSON
        const contentType = response.headers.get('content-type');
        if (!contentType || !contentType.includes('application/json')) {
            return response.text().then(text => {
                console.error('Server returned HTML instead of JSON:', text.substring(0, 500));
                throw new Error('Server returned HTML. Check server logs.');
            });
        }
        return response.json();
    })
    .then(data => {
        if (data.success) {
            // Close modal
            const modal = bootstrap.Modal.getInstance(document.getElementById('applyOfferModal'));
            modal.hide();

            showToast('success', data.message);

            // Update applications count in the table
            const applicationsBadge = document.querySelector(`#offer-${offerId} .badge.bg-primary`);
            if (applicationsBadge) {
                const currentCount = parseInt(applicationsBadge.textContent) || 0;
                applicationsBadge.textContent = currentCount + 1;
            }
        } else {
            showToast('error', data.error || 'Application submission failed');
        }
    })
    .catch(error => {
        console.error('Application error:', error);
        showToast('error', error.message || 'An error occurred');
    });
}

function deleteOfferWithApplications(offerId) {
    fetch(`/offers/${offerId}/delete?deleteMode=with_applications`, {
        method: 'DELETE',
        headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
        }
    })
    .then(response => response.json())
    .then(data => {
        // Close modal
        const modal = bootstrap.Modal.getInstance(document.getElementById('deleteConfirmationModal'));
        if (modal) modal.hide();

        if (data.success) {
            // Remove row from table
            const row = document.getElementById(`offer-${offerId}`);
            if (row) row.remove();

            showToast('success', data.message);

            // Check if table is empty
            const tbody = document.getElementById('offersTableBody');
            if (tbody && tbody.children.length === 0) {
                // Add empty state message
                tbody.innerHTML = `
                    <tr>
                        <td colspan="9" class="text-center py-5">
                            <i class="bi bi-briefcase" style="font-size: 3rem; color: #dee2e6;"></i>
                            <h5 class="text-muted mt-3">No job offers found</h5>
                            {% if is_granted('ROLE_RECRUITER') %}
                                <p class="text-muted">Click "Create New Offer" to add your first job offer</p>
                            {% else %}
                                <p class="text-muted">Check back soon for new opportunities</p>
                            {% endif %}
                        </td>
                    </tr>
                `;
            }
        } else {
            showToast('error', data.error || 'Delete failed');
        }
    })
    .catch(error => {
        console.error('Delete error:', error);
        showToast('error', 'Network error occurred');
    });
}

// SHOW OFFER DETAILS
function showOfferDetails(offerId) {
    fetch(`/offers/${offerId}/show`)
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const offer = data.offer;

                // Fill modal with data
                document.getElementById('viewOfferTitle').textContent = offer.title;
                document.getElementById('viewDescription').textContent = offer.description;
                document.getElementById('viewContractType').textContent = offer.contractType || 'Full-time';
                document.getElementById('viewLocation').textContent = offer.location || 'Remote';
                document.getElementById('viewSalary').textContent = offer.salary || 'Not specified';
                document.getElementById('viewCreatedAt').textContent = offer.createdAt;
                document.getElementById('viewRecruiter').textContent = offer.recruiter;
                document.getElementById('viewApplicationsCount').textContent = offer.applicationsCount;

                // Render skills as badges
                const skillsContainer = document.getElementById('viewSkills');
                skillsContainer.innerHTML = '';
                if (offer.skills) {
                    offer.skills.split(',').forEach(skill => {
                        if (skill.trim()) {
                            const badge = document.createElement('span');
                            badge.className = 'skill-badge me-2 mb-2';
                            badge.textContent = skill.trim();
                            skillsContainer.appendChild(badge);
                        }
                    });
                }

                // Show modal
                const modal = new bootstrap.Modal(document.getElementById('viewOfferModal'));
                modal.show();
            }
        });
}

// APPLY TO OFFER (placeholder for now)
function applyToOffer(offerId) {
    alert('Apply functionality will be implemented in the Applications CRUD section');
}

// HELPER FUNCTIONS
function showToast(type, message) {
    // Create toast container if it doesn't exist
    let container = document.getElementById('toastContainer');
    if (!container) {
        container = document.createElement('div');
        container.id = 'toastContainer';
        container.className = 'toast-container position-fixed bottom-0 end-0 p-3';
        container.style.zIndex = '1060';
        document.body.appendChild(container);
    }

    // Create toast
    const toastId = 'toast-' + Date.now();
    const toast = document.createElement('div');
    toast.id = toastId;
    toast.className = `toast align-items-center text-white border-0`;

    // Set background color
    if (type === 'error') {
        toast.classList.add('bg-danger');
    } else if (type === 'success') {
        toast.classList.add('bg-success');
    } else if (type === 'warning') {
        toast.classList.add('bg-warning');
    } else {
        toast.classList.add('bg-info');
    }

    toast.setAttribute('role', 'alert');
    toast.setAttribute('aria-live', 'assertive');
    toast.setAttribute('aria-atomic', 'true');

    toast.innerHTML = `
        <div class="d-flex">
            <div class="toast-body" style="color: white; font-weight: 500;">
                <i class="bi ${type === 'success' ? 'bi-check-circle' : type === 'error' ? 'bi-exclamation-circle' : 'bi-info-circle'} me-2"></i>
                ${message}
            </div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
    `;

    container.appendChild(toast);

    // Show toast
    const bsToast = new bootstrap.Toast(toast, { delay: 3000 });
    bsToast.show();

    // Remove from DOM after hide
    toast.addEventListener('hidden.bs.toast', () => {
        toast.remove();
    });
}

function createToastContainer() {
    const container = document.createElement('div');
    container.id = 'toastContainer';
    container.className = 'toast-container position-fixed bottom-0 end-0 p-3';
    container.style.zIndex = '1060';
    document.body.appendChild(container);
    return container;
}

function showFormErrors(errors) {
    // Clear previous errors
    document.querySelectorAll('.is-invalid').forEach(el => el.classList.remove('is-invalid'));
    document.querySelectorAll('.invalid-feedback').forEach(el => el.textContent = '');

    // Show new errors
    errors.forEach(error => {
        const field = error.toLowerCase().includes('title') ? 'title' :
                    error.toLowerCase().includes('description') ? 'description' :
                    error.toLowerCase().includes('skills') ? 'skills' : null;

        if (field) {
            const input = document.getElementById(field === 'skills' ? 'skills' : field);
            const errorDiv = document.getElementById(field + 'Error');

            if (input && errorDiv) {
                input.classList.add('is-invalid');
                errorDiv.textContent = error;
            }
        }
    });
}

// Enable enter key for search
document.addEventListener('DOMContentLoaded', function() {
    // Create toast container
    createToastContainer();

    // Add enter key support for search inputs
    const searchInput = document.getElementById('searchInput');
    const skillsFilter = document.getElementById('skillsFilter');

    if (searchInput) {
        searchInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                performSearch();
            }
        });
    }

    if (skillsFilter) {
        skillsFilter.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                performSearch();
            }
        });
    }
});
</script>
{% endblock %}


==========================================================================================
FILE: templates\profile\index.html.twig
==========================================================================================

{% extends 'base.html.twig' %}

{% block title %}My Profile - HireFlow{% endblock %}

{% block stylesheets %}
{{ parent() }}
<style>
    /* Profile Page Specific Styles */
    .profile-card {
        border-radius: 10px;
        margin-bottom: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        transition: transform 0.3s;
    }
    .profile-card:hover {
        transform: translateY(-2px);
    }
    .profile-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 10px 10px 0 0;
        padding: 20px;
    }
    .profile-header h5 {
        color: white;
        margin: 0;
    }
    .account-status-badge {
        padding: 8px 15px;
        border-radius: 20px;
        font-weight: 600;
    }
    .input-group-text {
        background-color: #f8f9fa;
        border-right: none;
        min-width: 45px;
        justify-content: center;
    }
    .form-control:focus {
        box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
        border-color: #86b7fe;
    }
    .danger-zone {
        border-left: 4px solid #dc3545;
        background-color: #f8f9fa;
    }
    .member-since {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
        padding: 10px 15px;
        border-radius: 8px;
        margin-bottom: 20px;
    }
</style>
{% endblock %}

{% block body %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <!-- Page Header with Stats -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h1 class="h3 mb-0 text-dark">
                    <i class="bi bi-person-circle me-2"></i>My Profile
                </h1>
                <div class="d-flex align-items-center gap-2">
                    <span class="account-status-badge bg-primary">
                        {% if is_granted('ROLE_CANDIDATE') %}
                            <i class="bi bi-person-badge me-1"></i> Candidate
                        {% elseif is_granted('ROLE_RECRUITER') %}
                            <i class="bi bi-briefcase me-1"></i> Recruiter
                        {% endif %}
                    </span>
                </div>
            </div>

            <!-- Member Since Card -->
            <div class="member-since mb-4">
                <div class="d-flex align-items-center">
                    <i class="bi bi-calendar3 me-3" style="font-size: 1.5rem;"></i>
                    <div>
                        <h6 class="mb-0">Member Since</h6>
                        <p class="mb-0">{{ user.createdAt ? user.createdAt|date('F j, Y') : 'Recently' }}</p>
                    </div>
                </div>
            </div>

            <!-- Profile Information Card -->
            <div class="card profile-card border-0">
                <div class="profile-header">
                    <h5 class="mb-0">
                        <i class="bi bi-person-lines-fill me-2"></i>Personal Information
                    </h5>
                    <p class="mb-0 opacity-75">Update your personal details here</p>
                </div>
                <div class="card-body">
                    {{ form_start(profileForm, {
                        'attr': {
                            'class': 'needs-validation',
                            'novalidate': 'novalidate'
                        }
                    }) }}

                    <div class="row">
                        <!-- Full Name -->
                        <div class="col-md-6 mb-3">
                            {{ form_label(profileForm.fullName, null, {
                                'label_attr': {'class': 'form-label fw-semibold text-dark'}
                            }) }}
                            <div class="input-group">
                                <span class="input-group-text">
                                    <i class="bi bi-person"></i>
                                </span>
                                {{ form_widget(profileForm.fullName, {
                                    'attr': {
                                        'class': 'form-control' ~ (profileForm.fullName.vars.errors|length > 0 ? ' is-invalid' : '')
                                    }
                                }) }}
                                {% if profileForm.fullName.vars.errors|length > 0 %}
                                    <div class="invalid-feedback d-block">
                                        <i class="bi bi-exclamation-triangle me-1"></i>
                                        {{ profileForm.fullName.vars.errors[0].message }}
                                    </div>
                                {% endif %}
                            </div>
                        </div>

                        <!-- Email -->
                        <div class="col-md-6 mb-3">
                            {{ form_label(profileForm.email, null, {
                                'label_attr': {'class': 'form-label fw-semibold text-dark'}
                            }) }}
                            <div class="input-group">
                                <span class="input-group-text">
                                    <i class="bi bi-envelope"></i>
                                </span>
                                {{ form_widget(profileForm.email, {
                                    'attr': {
                                        'class': 'form-control' ~ (profileForm.email.vars.errors|length > 0 ? ' is-invalid' : '')
                                    }
                                }) }}
                                {% if profileForm.email.vars.errors|length > 0 %}
                                    <div class="invalid-feedback d-block">
                                        <i class="bi bi-exclamation-triangle me-1"></i>
                                        {{ profileForm.email.vars.errors[0].message }}
                                    </div>
                                {% endif %}
                            </div>
                        </div>

                        <!-- Phone -->
                        <div class="col-md-6 mb-3">
                            {{ form_label(profileForm.phone, null, {
                                'label_attr': {'class': 'form-label fw-semibold text-dark'}
                            }) }}
                            <div class="input-group">
                                <span class="input-group-text">
                                    <i class="bi bi-telephone"></i>
                                </span>
                                {{ form_widget(profileForm.phone, {
                                    'attr': {
                                        'class': 'form-control' ~ (profileForm.phone.vars.errors|length > 0 ? ' is-invalid' : '')
                                    }
                                }) }}
                                {% if profileForm.phone.vars.errors|length > 0 %}
                                    <div class="invalid-feedback d-block">
                                        <i class="bi bi-exclamation-triangle me-1"></i>
                                        {{ profileForm.phone.vars.errors[0].message }}
                                    </div>
                                {% endif %}
                            </div>
                            <div class="form-text text-muted">Optional - used for recruitment purposes</div>
                        </div>

                        <!-- User ID (Read-only) -->
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-semibold text-dark">User ID</label>
                            <div class="input-group">
                                <span class="input-group-text">
                                    <i class="bi bi-hash"></i>
                                </span>
                                <input type="text" class="form-control" value="USER-{{ user.id|default('0000') }}" readonly>
                            </div>
                            <div class="form-text text-muted">Your unique identifier in the system</div>
                        </div>

                        <!-- Account Status -->
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-semibold text-dark">Account Status</label>
                            <div class="input-group">
                                <span class="input-group-text">
                                    <i class="bi bi-shield-check"></i>
                                </span>
                                <input type="text" class="form-control" value="Active" readonly>
                            </div>
                            <div class="form-text text-muted">
                                <i class="bi bi-check-circle-fill text-success me-1"></i>
                                Your account is active and verified
                            </div>
                        </div>
                    </div>

                    <!-- Form Actions -->
                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="d-flex justify-content-between">
                                <a href="{{ is_granted('ROLE_CANDIDATE') ? path('candidate_dashboard') : path('recruiter_dashboard') }}"
                                   class="btn btn-outline-secondary">
                                    <i class="bi bi-arrow-left me-1"></i> Back to Dashboard
                                </a>
                                <button type="submit" class="btn btn-primary px-4">
                                    <i class="bi bi-save me-1"></i> Save Changes
                                </button>
                            </div>
                        </div>
                    </div>

                    {{ form_end(profileForm) }}
                </div>
            </div>

            <!-- Account Security Card -->
            <div class="card profile-card border-0">
                <div class="card-header bg-white border-0 py-3">
                    <h5 class="card-title mb-0 text-dark">
                        <i class="bi bi-shield-lock me-2"></i>Account Security
                    </h5>
                    <p class="text-muted small mb-0">Manage your account security settings</p>
                </div>
                <div class="card-body">
                    <div class="row">
                        <!-- Password Management -->
                        <div class="col-md-6 mb-4">
                            <div class="d-flex align-items-center mb-2">
                                <div class="bg-light rounded-circle p-2 me-3">
                                    <i class="bi bi-key" style="font-size: 1.5rem;"></i>
                                </div>
                                <div>
                                    <h6 class="mb-1 text-dark">Password</h6>
                                    <p class="text-muted small mb-0">Last changed: Recently</p>
                                </div>
                            </div>
                            <a href="#" class="btn btn-outline-warning btn-sm">
                                <i class="bi bi-lock me-1"></i> Change Password
                            </a>
                        </div>

                        <!-- Email Verification -->
                        <div class="col-md-6 mb-4">
                            <div class="d-flex align-items-center mb-2">
                                <div class="bg-light rounded-circle p-2 me-3">
                                    <i class="bi bi-envelope-check" style="font-size: 1.5rem;"></i>
                                </div>
                                <div>
                                    <h6 class="mb-1 text-dark">Email Verification</h6>
                                    <p class="text-muted small mb-0">{{ user.email }}</p>
                                </div>
                            </div>
                            <span class="badge bg-success">
                                <i class="bi bi-check-circle me-1"></i> Verified
                            </span>
                        </div>
                    </div>

                    <!-- Danger Zone -->
                    <div class="danger-zone p-4 rounded mt-4">
                        <h6 class="text-danger mb-3">
                            <i class="bi bi-exclamation-triangle me-2"></i>Danger Zone
                        </h6>

                        <!-- Delete Account Button -->
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-1 text-dark">Delete Account</h6>
                                <p class="text-muted small mb-0">
                                    Permanently delete your account and all associated data. This action cannot be undone.
                                </p>
                            </div>
                            <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#deleteAccountModal">
                                <i class="bi bi-trash me-1"></i> Delete Account
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Delete Account Confirmation Modal -->
<div class="modal fade" id="deleteAccountModal" tabindex="-1" aria-labelledby="deleteAccountModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header border-0">
                <h5 class="modal-title text-danger" id="deleteAccountModalLabel">
                    <i class="bi bi-exclamation-triangle-fill me-2"></i>Delete Account
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="text-center mb-4">
                    <div class="bg-danger bg-opacity-10 rounded-circle d-inline-flex p-4 mb-3">
                        <i class="bi bi-trash-fill text-danger" style="font-size: 2.5rem;"></i>
                    </div>
                    <h4 class="text-dark mb-3">Are you absolutely sure?</h4>
                    <p class="text-muted">
                        This action <strong class="text-danger">cannot be undone</strong>. This will permanently delete:
                    </p>
                    <ul class="list-group list-group-flush text-start mb-4">
                        <li class="list-group-item border-0">
                            <i class="bi bi-x-circle-fill text-danger me-2"></i>
                            Your personal profile information
                        </li>
                        {% if is_granted('ROLE_CANDIDATE') %}
                        <li class="list-group-item border-0">
                            <i class="bi bi-x-circle-fill text-danger me-2"></i>
                            All your job applications
                        </li>
                        {% elseif is_granted('ROLE_RECRUITER') %}
                        <li class="list-group-item border-0">
                            <i class="bi bi-x-circle-fill text-danger me-2"></i>
                            All your job offers
                        </li>
                        <li class="list-group-item border-0">
                            <i class="bi bi-x-circle-fill text-danger me-2"></i>
                            All applications for your offers
                        </li>
                        {% endif %}
                    </ul>
                    <div class="alert alert-warning">
                        <i class="bi bi-info-circle me-2"></i>
                        You will be logged out immediately and redirected to the home page.
                    </div>
                </div>
            </div>
            <div class="modal-footer border-0">
                <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                    <i class="bi bi-x-lg me-1"></i> Cancel
                </button>
                <form action="{{ path('profile_delete') }}" method="POST" id="deleteAccountForm">
                    <input type="hidden" name="_token" value="{{ csrf_token('delete-account') }}">
                    <button type="submit" class="btn btn-danger">
                        <i class="bi bi-trash me-1"></i> Yes, Delete My Account
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block javascripts_body %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Form validation
    const forms = document.querySelectorAll('.needs-validation');

    Array.from(forms).forEach(function(form) {
        form.addEventListener('submit', function(event) {
            if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
            }
            form.classList.add('was-validated');
        }, false);
    });

    // Delete account confirmation
    const deleteForm = document.getElementById('deleteAccountForm');
    if (deleteForm) {
        deleteForm.addEventListener('submit', function(e) {
            if (!confirm('Are you absolutely sure you want to delete your account? This action cannot be undone!')) {
                e.preventDefault();
            }
        });
    }

    // Bootstrap modal cleanup
    const deleteModal = document.getElementById('deleteAccountModal');
    if (deleteModal) {
        deleteModal.addEventListener('hidden.bs.modal', function () {
            // Reset any form states if needed
        });
    }
});
</script>
{% endblock %}


==========================================================================================
FILE: templates\recruiter_dashboard\index.html.twig
==========================================================================================

{% extends 'base.html.twig' %}

{% block title %}Recruiter Dashboard - HireFlow{% endblock %}

{% block stylesheets %}
{{ parent() }}
<style>
    /* Custom Styles for Recruiter Dashboard */
    .stat-card {
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        transition: transform 0.3s;
        color: white;
    }
    .stat-card:hover {
        transform: translateY(-5px);
    }
    .stat-card.total-offers { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    .stat-card.total-apps { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
    .stat-card.pending { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
    .stat-card.accepted { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
    .stat-card.rejected { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }

    .stat-number {
        font-size: 2.5rem;
        font-weight: bold;
        margin: 0;
    }
    .stat-label {
        color: rgba(255,255,255,0.9);
        font-size: 1rem;
        margin: 0;
        opacity: 0.9;
    }

    .status-badge {
        padding: 5px 15px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 600;
        display: inline-block;
    }
    .status-pending { background: #fff3cd; color: #856404; }
    .status-accepted { background: #d4edda; color: #155724; }
    .status-rejected { background: #f8d7da; color: #721c24; }

    .btn-quick-action {
        padding: 8px 20px;
        border-radius: 6px;
        font-weight: 600;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s;
    }
    .btn-quick-action:hover {
        transform: translateY(-2px);
        text-decoration: none;
    }

    .btn-accept-quick {
        background: #28a745;
        color: white;
        border: none;
    }
    .btn-accept-quick:hover {
        background: #218838;
        color: white;
    }

    .btn-reject-quick {
        background: #dc3545;
        color: white;
        border: none;
    }
    .btn-reject-quick:hover {
        background: #c82333;
        color: white;
    }

    .btn-view {
        background: #6c757d;
        color: white;
        padding: 5px 15px;
        border-radius: 4px;
        text-decoration: none;
        font-size: 0.85rem;
    }
    .btn-view:hover {
        background: #5a6268;
        color: white;
    }

    .offer-title-link {
        color: #495057;
        text-decoration: none;
        font-weight: 600;
    }
    .offer-title-link:hover {
        color: #007bff;
        text-decoration: underline;
    }

    .application-row {
        transition: background-color 0.2s;
    }
    .application-row:hover {
        background-color: #f8f9fa;
    }

    .table th {
        border-top: none;
        font-weight: 600;
        color: #495057;
        background-color: #f8f9fa;
    }

    .empty-state {
        padding: 60px 20px;
        text-align: center;
        color: #6c757d;
    }
    .empty-state i {
        font-size: 4rem;
        margin-bottom: 20px;
        color: #dee2e6;
    }
</style>
{% endblock %}

{% block body %}
<div class="container-fluid">
    <!-- Page Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h1 class="h3 mb-0">Welcome, {{ app.user.fullName }} </h1>
            <p class="text-muted mb-0">Recruiter Dashboard • Manage your job offers and applications</p>
        </div>
        <div class="d-flex gap-2">
            {# <!-- We'll uncomment these when we create the pages -->
            <!--
            <a href="{{ path('offer_new') }}" class="btn btn-primary">
                <i class="bi bi-plus-circle me-2"></i>New Job Offer
            </a>
            <a href="{{ path('application_index') }}" class="btn btn-outline-primary">
                <i class="bi bi-list-check me-2"></i>All Applications
            </a>
            --> #}
        </div>
    </div>

    <!-- Quick Stats -->
    <div class="row mb-4">
        <div class="col">
            <div class="alert alert-info d-flex align-items-center">
                <i class="bi bi-info-circle me-3" style="font-size: 1.5rem;"></i>
                <div>
                    <strong>Quick Stats Overview:</strong> You have {{ stats.total_offers|default(0) }} active job offers and received {{ stats.total_applications|default(0) }} applications total.
                </div>
            </div>
        </div>
    </div>

    <!-- Statistics Cards -->
    <div class="row mb-5">
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="stat-card total-offers h-100">
                <div class="d-flex align-items-center">
                    <div class="flex-grow-1">
                        <p class="stat-label">Total Offers</p>
                        <h2 class="stat-number">{{ stats.total_offers|default(0) }}</h2>
                    </div>
                    <div class="ms-3">
                        <i class="bi bi-briefcase" style="font-size: 2.5rem; color: rgba(255,255,255,0.8);"></i>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-4">
            <div class="stat-card total-apps h-100">
                <div class="d-flex align-items-center">
                    <div class="flex-grow-1">
                        <p class="stat-label">Total Applications</p>
                        <h2 class="stat-number">{{ stats.total_applications|default(0) }}</h2>
                    </div>
                    <div class="ms-3">
                        <i class="bi bi-people" style="font-size: 2.5rem; color: rgba(255,255,255,0.8);"></i>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-2 col-md-4 mb-4">
            <div class="stat-card pending h-100">
                <div class="d-flex align-items-center">
                    <div class="flex-grow-1">
                        <p class="stat-label">Pending</p>
                        <h2 class="stat-number">{{ stats.pending|default(0) }}</h2>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-2 col-md-4 mb-4">
            <div class="stat-card accepted h-100">
                <div class="d-flex align-items-center">
                    <div class="flex-grow-1">
                        <p class="stat-label">Accepted</p>
                        <h2 class="stat-number">{{ stats.accepted|default(0) }}</h2>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-2 col-md-4 mb-4">
            <div class="stat-card rejected h-100">
                <div class="d-flex align-items-center">
                    <div class="flex-grow-1">
                        <p class="stat-label">Rejected</p>
                        <h2 class="stat-number">{{ stats.rejected|default(0) }}</h2>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Two Columns Layout -->
    <div class="row">
        <!-- Recent Applications -->
        <div class="col-lg-7 mb-4">
            <div class="card shadow-sm h-100">
                <div class="card-header bg-white border-bottom d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">Recent Applications</h5>
                    <span class="badge bg-secondary">Latest 5</span>
                </div>
                <div class="card-body p-0">
                    {% if applications|length > 0 %}
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead>
                                    <tr>
                                        <th>Candidate</th>
                                        <th>Position</th>
                                        <th>Applied</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for application in applications|slice(0, 5) %}
                                    <tr class="application-row">
                                        <td>
                                            <div class="fw-semibold">{{ application.candidate.fullName }}</div>
                                            <small class="text-muted">{{ application.candidate.email }}</small>
                                        </td>
                                        <td>
                                            <a href="#" class="offer-title-link">
                                                {{ application.offer.title }}
                                            </a>
                                        </td>
                                        <td>{{ application.createdAt|date('M d') }}</td>
                                        <td>
                                            <span class="status-badge status-{{ application.status|lower }}">
                                                {{ application.status }}
                                            </span>
                                        </td>

                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% else %}
                        <div class="empty-state">
                            <i class="bi bi-person-x"></i>
                            <h5 class="text-muted mb-3">No applications yet</h5>
                            <p class="text-muted">Applications will appear here when candidates apply to your job offers.</p>
                        </div>
                    {% endif %}
                </div>
                {% if applications|length > 0 %}
                    <div class="card-footer bg-white border-top text-center py-3">
                        <small class="text-muted">Showing {{ applications|slice(0, 5)|length }} of {{ applications|length }} applications</small>
                    </div>
                {% endif %}
            </div>
        </div>

        <!-- Your Job Offers -->
        <div class="col-lg-5 mb-4">
            <div class="card shadow-sm h-100">
                <div class="card-header bg-white border-bottom d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">Your Job Offers</h5>
                    {# <!-- We'll uncomment when we create the offer_new route -->
                    <!-- <a href="{{ path('offer_new') }}" class="btn btn-sm btn-primary">
                        <i class="bi bi-plus"></i> New
                    </a> --> #}
                </div>
                <div class="card-body p-0">
                    {% if offers|length > 0 %}
                        <div class="list-group list-group-flush">
                            {% for offer in offers|slice(0, 5) %}
                            <div class="list-group-item">
                                <div class="d-flex justify-content-between align-items-start">
                                    <div class="flex-grow-1">
                                        <h6 class="mb-1">
                                            <a href="#" class="text-dark text-decoration-none">
                                                {{ offer.title }}
                                            </a>
                                        </h6>
                                        <p class="mb-1 text-muted small">{{ offer.description|slice(0, 80) }}...</p>
                                        <div class="d-flex align-items-center mt-2">
                                            <small class="text-muted me-3">
                                                <i class="bi bi-calendar3 me-1"></i>
                                                {{ offer.createdAt|date('M d, Y') }}
                                            </small>
                                            <small class="text-muted">
                                                <i class="bi bi-person-plus me-1"></i>
                                                {{ offer.applications|length }} applications
                                            </small>
                                        </div>
                                    </div>
                                    <div class="ms-3">
                                        <span class="badge bg-light text-dark">
                                            {{ offer.contractType|default('Full-time') }}
                                        </span>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <div class="empty-state">
                            <i class="bi bi-briefcase"></i>
                            <h5 class="text-muted mb-3">No job offers yet</h5>
                            <p class="text-muted mb-4">Create your first job offer to start receiving applications.</p>
                            <!-- We'll uncomment when we create the offer_new route -->
                            <!-- <a href="{{ path('offer_new') }}" class="btn btn-primary">
                                <i class="bi bi-plus-circle me-2"></i>Create First Offer
                            </a> -->
                        </div>
                    {% endif %}
                </div>
                {% if offers|length > 0 %}
                    <div class="card-footer bg-white border-top">
                        <div class="row">
                            <div class="col">
                                <small class="text-muted">{{ offers|length }} total offers</small>
                            </div>
                            <div class="col text-end">
                                <!-- We'll uncomment when we create the offer_index route -->
                                <!-- <a href="{{ path('offer_index') }}" class="btn btn-sm btn-outline-primary">
                                    View All <i class="bi bi-arrow-right ms-1"></i>
                                </a> -->
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>

</div>
{% endblock %}

{% block javascripts_body %}
<script>
// This will be used for quick actions later
document.addEventListener('DOMContentLoaded', function() {

    // Status badge colors based on status
    document.querySelectorAll('.status-badge').forEach(badge => {
        const status = badge.textContent.trim().toLowerCase();
        badge.className = `status-badge status-${status}`;
    });
});
</script>
{% endblock %}


==========================================================================================
FILE: templates\registration\register.html.twig
==========================================================================================

{% extends 'base.html.twig' %}

{% block title %}Register - HireFlow{% endblock %}

{% block stylesheets %}
{{ parent() }}
<style>
/* Enhanced Register Page Styles */

/* Main Container */
.register-container {
    max-width: 440px;
    margin: 80px auto 40px;
    padding: 48px 40px;
    background: #ffffff;
    border-radius: 12px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07), 0 2px 4px rgba(0, 0, 0, 0.05);
}

.register-container h1 {
    font-size: 28px;
    font-weight: 600;
    color: #1a202c;
    margin-bottom: 32px;
    text-align: center;
    letter-spacing: -0.5px;
}

/* Form Errors */
.register-container .alert,
.register-container .form-error-message {
    padding: 14px 16px;
    border-radius: 8px;
    font-size: 14px;
    margin-bottom: 24px;
    border: 1px solid #f5c6cb;
    background-color: #f8d7da;
    color: #721c24;
}

/* Form Rows */
.register-container .form-group,
.register-container > form > div {
    margin-bottom: 24px;
}

/* Labels */
.register-container label {
    display: block;
    font-size: 14px;
    font-weight: 500;
    color: #374151;
    margin-bottom: 8px;
    letter-spacing: 0.2px;
}

/* Input Fields */
.register-container input[type="text"],
.register-container input[type="email"],
.register-container input[type="password"],
.register-container textarea,
.register-container select,
.register-container .form-control {
    width: 100%;
    padding: 12px 16px;
    font-size: 15px;
    line-height: 1.5;
    color: #1a202c;
    background-color: #ffffff;
    border: 1.5px solid #d1d5db;
    border-radius: 8px;
    transition: all 0.2s ease;
    box-sizing: border-box;
}

.register-container input[type="text"]:focus,
.register-container input[type="email"]:focus,
.register-container input[type="password"]:focus,
.register-container textarea:focus,
.register-container select:focus,
.register-container .form-control:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

/* Checkbox Styling */
.register-container input[type="checkbox"] {
    width: 18px;
    height: 18px;
    margin-right: 8px;
    cursor: pointer;
    accent-color: #3b82f6;
    vertical-align: middle;
}

.register-container .form-check label,
.register-container input[type="checkbox"] ~ label {
    display: inline;
    font-size: 14px;
    font-weight: 400;
    color: #4b5563;
    cursor: pointer;
    vertical-align: middle;
}

/* Checkbox Container */
.register-container .form-check {
    display: flex;
    align-items: center;
    margin-bottom: 28px;
}

/* Submit Button */
.register-container button[type="submit"],
.register-container .btn {
    width: 100%;
    padding: 13px 24px;
    font-size: 15px;
    font-weight: 600;
    color: #ffffff;
    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-top: 8px;
    letter-spacing: 0.3px;
}

.register-container button[type="submit"]:hover,
.register-container .btn:hover {
    background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(37, 99, 235, 0.25);
}

.register-container button[type="submit"]:active,
.register-container .btn:active {
    transform: translateY(0);
    box-shadow: 0 2px 6px rgba(37, 99, 235, 0.25);
}

/* Field-level Error Messages */
.register-container .invalid-feedback,
.register-container .form-error,
.register-container span.error {
    display: block;
    margin-top: 6px;
    font-size: 13px;
    color: #dc2626;
}

/* Invalid Input State */
.register-container input.is-invalid,
.register-container select.is-invalid,
.register-container textarea.is-invalid {
    border-color: #dc2626;
}

.register-container input.is-invalid:focus,
.register-container select.is-invalid:focus,
.register-container textarea.is-invalid:focus {
    border-color: #dc2626;
    box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
}

/* Help Text */
.register-container .form-text,
.register-container small,
.register-container .help-block {
    display: block;
    margin-top: 6px;
    font-size: 13px;
    color: #6b7280;
    line-height: 1.5;
}

/* Footer Links */
.register-container p {
    margin-top: 24px;
    margin-bottom: 0;
    text-align: center;
    font-size: 14px;
    color: #6b7280;
    line-height: 1.6;
}

.register-container a {
    color: #3b82f6;
    text-decoration: none;
    font-weight: 500;
    transition: color 0.2s ease;
}

.register-container a:hover {
    color: #2563eb;
    text-decoration: underline;
}

/* Responsive Design */
@media (max-width: 576px) {
    .register-container {
        margin: 40px 20px;
        padding: 36px 28px;
        max-width: 100%;
    }

    .register-container h1 {
        font-size: 24px;
        margin-bottom: 28px;
    }

    .register-container .form-group,
    .register-container > form > div {
        margin-bottom: 20px;
    }

    .register-container button[type="submit"],
    .register-container .btn {
        padding: 12px 20px;
    }
}

/* Accessibility Enhancement */
.register-container input:focus-visible,
.register-container select:focus-visible,
.register-container textarea:focus-visible {
    outline: 2px solid #3b82f6;
    outline-offset: 2px;
}

/* Disabled State */
.register-container input:disabled,
.register-container select:disabled,
.register-container textarea:disabled {
    background-color: #f3f4f6;
    cursor: not-allowed;
    opacity: 0.6;
}

/* Page Background */
body {
    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
    min-height: 100vh;
}
</style>
{% endblock %}

{% block body %}
<div class="register-container">
    <h1>Create Your Account</h1>

    {{ form_errors(registrationForm) }}

    {{ form_start(registrationForm) }}

        {{ form_row(registrationForm.email, {
            'label': 'Email Address',
            'attr': {'class': 'form-control'}
        }) }}

        {{ form_row(registrationForm.fullName, {
            'label': 'Full Name',
            'attr': {'class': 'form-control'}
        }) }}

        {{ form_row(registrationForm.phone, {
            'label': 'Phone Number',
            'attr': {'class': 'form-control'}
        }) }}

        {{ form_row(registrationForm.plainPassword, {
            'label': 'Password',
            'attr': {'class': 'form-control'}
        }) }}

        <div class="form-check">
            {{ form_widget(registrationForm.agreeTerms, {
                'attr': {'class': 'form-check-input'}
            }) }}
            {{ form_label(registrationForm.agreeTerms, null, {
                'label_attr': {'class': 'form-check-label'}
            }) }}
            {{ form_errors(registrationForm.agreeTerms) }}
        </div>

        <button type="submit" class="btn btn-primary">Register</button>
    {{ form_end(registrationForm) }}

    <p>Already have an account? <a href="{{ path('app_login') }}">Login here</a></p>
</div>
{% endblock %}


==========================================================================================
FILE: templates\security\login.html.twig
==========================================================================================

{# templates/security/login.html.twig #}
{% extends 'base.html.twig' %}
{% block title %} Login-HireFlow {% endblock %}
{% block stylesheets %}
{{ parent() }}
<style>
.login-container {
    max-width: 440px;
    margin: 80px auto 40px;
    padding: 48px 40px;
    background: #ffffff;
    border-radius: 12px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07), 0 2px 4px rgba(0, 0, 0, 0.05);
}

.login-container h1 {
    font-size: 28px;
    font-weight: 600;
    color: #1a202c;
    margin-bottom: 32px;
    text-align: center;
    letter-spacing: -0.5px;
}

/* Alert Styling */
.login-container .alert {
    padding: 14px 16px;
    border-radius: 8px;
    font-size: 14px;
    margin-bottom: 24px;
    border: 1px solid #f5c6cb;
    background-color: #f8d7da;
    color: #721c24;
}

/* Form Group Styling */
.login-container .form-group {
    margin-bottom: 24px;
}

.login-container .form-group label {
    display: block;
    font-size: 14px;
    font-weight: 500;
    color: #374151;
    margin-bottom: 8px;
    letter-spacing: 0.2px;
}

.login-container .form-control {
    width: 100%;
    padding: 12px 16px;
    font-size: 15px;
    line-height: 1.5;
    color: #1a202c;
    background-color: #ffffff;
    border: 1.5px solid #d1d5db;
    border-radius: 8px;
    transition: all 0.2s ease;
    box-sizing: border-box;
}

.login-container .form-control:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.login-container .form-control::placeholder {
    color: #9ca3af;
}

/* Button Styling */
.login-container .btn-primary {
    width: 100%;
    padding: 13px 24px;
    font-size: 15px;
    font-weight: 600;
    color: #ffffff;
    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-top: 8px;
    letter-spacing: 0.3px;
}

.login-container .btn-primary:hover {
    background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(37, 99, 235, 0.25);
}

.login-container .btn-primary:active {
    transform: translateY(0);
    box-shadow: 0 2px 6px rgba(37, 99, 235, 0.25);
}

/* Footer Links */
.login-container p {
    margin-top: 24px;
    margin-bottom: 0;
    text-align: center;
    font-size: 14px;
    color: #6b7280;
    line-height: 1.6;
}

.login-container p:last-child {
    margin-top: 12px;
}

.login-container p small {
    font-size: 13px;
    color: #9ca3af;
}

.login-container a {
    color: #3b82f6;
    text-decoration: none;
    font-weight: 500;
    transition: color 0.2s ease;
}

.login-container a:hover {
    color: #2563eb;
    text-decoration: underline;
}

/* Responsive Design */
@media (max-width: 576px) {
    .login-container {
        margin: 40px 20px;
        padding: 36px 28px;
        max-width: 100%;
    }

    .login-container h1 {
        font-size: 24px;
        margin-bottom: 28px;
    }

    .login-container .form-group {
        margin-bottom: 20px;
    }

    .login-container .btn-primary {
        padding: 12px 20px;
    }
}

/* Additional Polish */
.login-container form {
    margin-bottom: 0;
}

.login-container .form-control:disabled {
    background-color: #f3f4f6;
    cursor: not-allowed;
    opacity: 0.6;
}

/* Accessibility Enhancement */
.login-container .form-control:focus-visible {
    outline: 2px solid #3b82f6;
    outline-offset: 2px;
}

</style>
{% endblock %}
{% block body %}
<div class="login-container">
    <h1>Login</h1>

    {% if error %}
        <div class="alert alert-danger">{{ error.messageKey|trans(error.messageData,"security")}}</div>
    {% endif %}

    <form method="post">
        <div class="form-group">
            <label for="email">Email</label>
            <input type="email" value="{{ last_username }}" name="email" id="email" class="form-control" autocomplete="email" required autofocus>
        </div>

        <div class="form-group">
            <label for="password">Password</label>
            <input type="password" name="password" id="password" class="form-control" autocomplete="current-password" required>
        </div>

        <input type="hidden" name="_csrf_token" value="{{ csrf_token('authenticate') }}">

        <button class="btn btn-primary" type="submit">Login</button>
    </form>

    <p>Don't have an account? <a href="{{ path('app_register') }}">Register as Candidate</a></p>
    <p><small>Recruiters: Use pre-created accounts (check fixtures)</small></p>
</div>
{% endblock %}

